checks:
  ssl_enabled: |
    @hotsos.core.plugins.openstack.OpenstackBase.ssl_enabled == True
  apache2_certificate_expiring: |
    len(@hotsos.core.plugins.openstack.OpenstackBase.apache2_certificates_expiring) > 0
conclusions:
  need-certificate-renewal:
    decision:
      - ssl_enabled
      - apache2_certificate_expiring
    raises:
      type: OpenstackWarning
      message: >-
        The following certificates will expire in less than {apache2-certificates-days-to-expire} days:
        {apache2-certificates-path}
      format-dict:
        apache2-certificates-path: hotsos.core.plugins.openstack.OpenstackBase.apache2_certificates_expiring:comma_join
        apache2-certificates-days-to-expire: hotsos.core.plugins.openstack.OpenstackBase.certificate_expire_days
