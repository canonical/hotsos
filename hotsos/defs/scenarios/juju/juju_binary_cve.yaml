checks:
  has_affected_juju_binary:
    binary:
      handler: hotsos.core.plugins.juju.JujuBinaryInterface
      juju:
        - min: '1.0.0'
          max: '2.9.49'
        - min: '3.0.0'
          max: '3.1.8'
        - min: '3.2.0'
          max: '3.3.4'
        - min: '3.4.0'
          max: '3.4.2'
conclusions:
  juju_binary_cve:
    decision: has_affected_juju_binary
    raises:
      type: MitreCVE
      cve-id: CVE-2024-3250
      message: >-
        This host is running a version of Juju ({version}) that is
        affected by a known security vulnerability. Please upgrade
        to the latest version to get the fix.
      format-dict:
        version: '@checks.has_affected_juju_binary.requires.version'
