vars:
  limit: 5242880  # 5G in kb
  northd_usage: '@hotsos.core.host_helpers.systemd.ServiceFactory.memory_current_kb:ovn-northd'
checks:
  northd_mem_use_above_limit:
    systemd: ovn-northd
    varops: [[$northd_usage], [gt, $limit]]
conclusions:
  northd_overuse:
    decision: northd_mem_use_above_limit
    raises:
      type: OpenvSwitchWarning
      message: >-
        The ovn-northd service is consuming more than 5G memory (current_kb={usage}). This is
        not normal and could indicate a memory leak. Please check.
      format-dict:
        usage: $northd_usage
