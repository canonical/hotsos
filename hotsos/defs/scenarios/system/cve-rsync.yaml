checks:
  has_rsync_cve:
    apt:
      rsync:
        # Oracular
        - min: '3.3.0-1'
          max: '3.3.0-1'
        # Noble
        - min: '3.2.7-1ubuntu1'
          max: '3.2.7-1ubuntu1'
        # Jammy
        - min: '3.2.3-8ubuntu3'
          max: '3.2.7-0ubuntu0.22.04.2'
        # Focal
        - min: '3.1.3-8'
          max: '3.1.3-8ubuntu0.7'
        # Bionic
        - min: '3.1.2-2.1ubuntu1'
          max: '3.1.2-2.1ubuntu1.6'
        # Xenial
        - min: '3.1.1-3ubuntu1'
          max: '3.1.1-3ubuntu1.3'
        # Trusty
        - min: '3.1.0-2'
          max: '3.1.0-2ubuntu0.4'
conclusions:
  rsync_cve:
    decision: has_rsync_cve
    raises:
      type: MitreCVE
      cve-id: CVE-2024-12084
      message: >-
        Installed package '{package}' with version {version} has a known
        security vulnerability (CVE-2024-12084). Please upgrade to the
        latest version to get the fix.
      format-dict:
        package: '@checks.has_rsync_cve.requires.package'
        version: '@checks.has_rsync_cve.requires.version'
