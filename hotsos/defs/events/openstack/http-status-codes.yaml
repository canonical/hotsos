# NOTE:
#   * for efficiency, do not capture time as subgroup unless actually
#     necessary.
#   * we disable all-logs for these searches in order to not overwhelm hotsos
#     since these will typically return very large numbers of results.
cinder:
  input:
    path: 'var/log/apache2/cinder_access.log'
    options:
      disable-all-logs: true
  expr: '.+(\d{2}/\w{3,5}/\d{4}).+HTTP/\d\.\d" (\d+)'
keystone:
  input:
    path: 'var/log/apache2/keystone_access.log'
    options:
      disable-all-logs: true
  expr: '.+(\d{2}/\w{3,5}/\d{4}).+HTTP/\d\.\d" (\d+)'
neutron:
  input:
    path: 'var/log/neutron/neutron-server.log'
    options:
      disable-all-logs: true
  expr: '([\d-]+) [\d:]+\.\d{3} .+ neutron.wsgi .+HTTP/\d\.\d" (\d+)'
nova:
  input:
    path: 'var/log/apache2/nova-api-os-compute_access.log'
    options:
      disable-all-logs: true
  expr: '.+(\d{2}/\w{3,5}/\d{4}).+HTTP/\d\.\d" (\d+)'
octavia:
  input:
    path: 'var/log/apache2/octavia_access.log'
    options:
      disable-all-logs: true
  expr: '.+(\d{2}/\w{3,5}/\d{4}).+HTTP/\d\.\d" (\d+)'
