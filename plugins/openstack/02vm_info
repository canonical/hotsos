#!/bin/bash -u

declare -a output=()

((VERBOSITY_LEVEL>=1)) || exit 0

echo "  vms:"

vm_indent="  ${INDENT_STR}"

if `get_ps| grep -q "product=OpenStack Nova"`; then
    readarray -t uuids<<<`get_ps| grep "product=OpenStack Nova"| sed -r 's/.+uuid=([[:alnum:]\-]+)[\s,]+.+/\1/g'`
    for uuid in ${uuids[@]}; do
        output+=( "$uuid" )
    done
fi

if ((${#output[@]})); then
    for line in "${output[@]}"; do
        echo "${vm_indent}$line"
    done
else
    echo "${vm_indent}null"
fi

