2025-05-14T04:24:44.021Z [pebble] HTTP API server listening on ":38812".
2025-05-14T04:24:44.021Z [pebble] Started daemon.
2025-05-14T04:24:44.096Z [pebble] POST /v1/services 74.18192ms 202
2025-05-14T04:24:44.122Z [pebble] Service "container-agent" starting: /charm/bin/containeragent unit --data-dir /var/lib/juju --append-env "PATH=$PATH:/charm/bin" --show-log --charm-modified-version 0
2025-05-14T04:24:44.181Z [container-agent] 2025-05-14 04:24:44 INFO juju.cmd supercommand.go:56 running containerAgent [3.6.5 33b026f4ab2a4fe371764b9c41993d3e1e90ddef gc go1.24.1]
2025-05-14T04:24:44.181Z [container-agent] starting containeragent unit command
2025-05-14T04:24:44.181Z [container-agent] containeragent unit "unit-nova-api-mysql-router-0" start (3.6.5 [gc])
2025-05-14T04:24:44.181Z [container-agent] 2025-05-14 04:24:44 INFO juju.cmd.containeragent.unit runner.go:592 start "unit"
2025-05-14T04:24:44.182Z [container-agent] 2025-05-14 04:24:44 INFO juju.worker.upgradesteps worker.go:60 upgrade steps for 3.6.5 have already been run.
2025-05-14T04:24:44.186Z [container-agent] 2025-05-14 04:24:44 INFO juju.worker.probehttpserver server.go:157 starting http server on 127.0.0.1:65301
2025-05-14T04:24:44.601Z [container-agent] 2025-05-14 04:24:44 INFO juju.api apiclient.go:979 cannot resolve "controller-service.controller-sunbeam-controller.svc.cluster.local": lookup controller-service.controller-sunbeam-controller.svc.cluster.local on 10.152.183.193:53: dial udp 10.152.183.193:53: connect: operation not permitted
2025-05-14T04:24:44.817Z [container-agent] 2025-05-14 04:24:44 INFO juju.api apiclient.go:979 cannot resolve "controller-service.controller-sunbeam-controller.svc.cluster.local": lookup controller-service.controller-sunbeam-controller.svc.cluster.local on 10.152.183.193:53: dial udp 10.152.183.193:53: connect: operation not permitted
2025-05-14T04:24:45.018Z [container-agent] 2025-05-14 04:24:45 ERROR juju.worker.dependency engine.go:695 "api-caller" manifold worker returned unexpected error: [ee070c] "unit-nova-api-mysql-router-0" cannot open api: cannot resolve "controller-service.controller-sunbeam-controller.svc.cluster.local": lookup controller-service.controller-sunbeam-controller.svc.cluster.local on 10.152.183.193:53: dial udp 10.152.183.193:53: connect: operation not permitted
2025-05-14T04:24:45.151Z [pebble] GET /v1/changes/61/wait 1.050158662s 200
2025-05-14T04:24:45.151Z [pebble] Started default services with change 61.
2025-05-14T04:24:49.588Z [container-agent] 2025-05-14 04:24:49 INFO juju.api apiclient.go:979 cannot resolve "controller-service.controller-sunbeam-controller.svc.cluster.local": lookup controller-service.controller-sunbeam-controller.svc.cluster.local on 10.152.183.193:53: dial udp 10.152.183.193:53: connect: operation not permitted
2025-05-14T04:24:49.991Z [container-agent] 2025-05-14 04:24:49 ERROR juju.worker.dependency engine.go:695 "api-caller" manifold worker returned unexpected error: [ee070c] "unit-nova-api-mysql-router-0" cannot open api: cannot resolve "controller-service.controller-sunbeam-controller.svc.cluster.local": lookup controller-service.controller-sunbeam-controller.svc.cluster.local on 10.152.183.193:53: dial udp 10.152.183.193:53: connect: operation not permitted
2025-05-14T04:24:54.061Z [pebble] Check "readiness" failure 1/3: non-2xx status code 418
2025-05-14T04:24:54.077Z [pebble] Check "liveness" failure 1/3: non-2xx status code 418
2025-05-14T04:24:55.590Z [container-agent] 2025-05-14 04:24:55 INFO juju.api apiclient.go:979 cannot resolve "controller-service.controller-sunbeam-controller.svc.cluster.local": lookup controller-service.controller-sunbeam-controller.svc.cluster.local on 10.152.183.193:53: dial udp 10.152.183.193:53: connect: operation not permitted
2025-05-14T04:24:55.798Z [container-agent] 2025-05-14 04:24:55 ERROR juju.worker.dependency engine.go:695 "api-caller" manifold worker returned unexpected error: [ee070c] "unit-nova-api-mysql-router-0" cannot open api: cannot resolve "controller-service.controller-sunbeam-controller.svc.cluster.local": lookup controller-service.controller-sunbeam-controller.svc.cluster.local on 10.152.183.193:53: dial udp 10.152.183.193:53: connect: operation not permitted
2025-05-14T04:25:02.186Z [container-agent] 2025-05-14 04:25:02 INFO juju.api apiclient.go:979 cannot resolve "controller-service.controller-sunbeam-controller.svc.cluster.local": lookup controller-service.controller-sunbeam-controller.svc.cluster.local on 10.152.183.193:53: dial udp 10.152.183.193:53: connect: operation not permitted
2025-05-14T04:25:02.203Z [container-agent] 2025-05-14 04:25:02 INFO juju.api apiclient.go:601 connection established to "wss://10.152.183.59:17070/model/ee070cdf-4b8b-49ac-80cb-918841540fbe/api"
2025-05-14T04:25:02.219Z [container-agent] 2025-05-14 04:25:02 INFO juju.worker.apicaller connect.go:163 [ee070c] "unit-nova-api-mysql-router-0" successfully connected to "wss://10.152.183.59:17070"
2025-05-14T04:25:02.245Z [container-agent] 2025-05-14 04:25:02 INFO juju.worker.migrationminion worker.go:208 migration phase is now: NONE
2025-05-14T04:25:02.247Z [container-agent] 2025-05-14 04:25:02 INFO juju.worker.logger logger.go:120 logger worker started
2025-05-14T04:25:02.276Z [container-agent] 2025-05-14 04:25:02 WARNING juju.worker.proxyupdater proxyupdater.go:237 unable to set snap core settings [proxy.http= proxy.https= proxy.store=]: exec: "snap": executable file not found in $PATH, output: ""
2025-05-14T04:25:02.296Z [container-agent] 2025-05-14 04:25:02 INFO juju.worker.leadership tracker.go:244 nova-api-mysql-router/0 promoted to leadership of nova-api-mysql-router
2025-05-14T04:25:02.298Z [container-agent] 2025-05-14 04:25:02 INFO juju.agent.tools symlinks.go:20 ensure jujuc symlinks in /var/lib/juju/tools/unit-nova-api-mysql-router-0
2025-05-14T04:25:02.326Z [container-agent] 2025-05-14 04:25:02 INFO juju.worker.caasupgrader upgrader.go:113 abort check blocked until version event received
2025-05-14T04:25:02.326Z [container-agent] 2025-05-14 04:25:02 INFO juju.worker.caasupgrader upgrader.go:119 unblocking abort check
2025-05-14T04:25:03.149Z [container-agent] 2025-05-14 04:25:03 INFO juju.worker.uniter uniter.go:365 unit "nova-api-mysql-router/0" started
2025-05-14T04:25:03.427Z [container-agent] 2025-05-14 04:25:03 INFO juju.worker.uniter uniter.go:391 hooks are retried true
2025-05-14T04:25:04.157Z [pebble] Check "readiness" failure 2/3: non-2xx status code 418
2025-05-14T04:25:04.854Z [container-agent] 2025-05-14 04:25:04 INFO juju.worker.uniter resolver.go:76 reboot detected; triggering implicit start hook to notify charm
2025-05-14T04:25:14.197Z [pebble] Check "readiness" failure 3/3: non-2xx status code 418
2025-05-14T04:25:14.217Z [pebble] Check "readiness" threshold 3 hit, triggering action and recovering
2025-05-14T04:25:14.219Z [pebble] Change 59 task (Perform HTTP check "readiness") failed: non-2xx status code 418
2025-05-14T04:25:24.357Z [pebble] Check "readiness" failure 4/3: non-2xx status code 418
2025-05-14T04:25:34.469Z [pebble] Check "readiness" failure 5/3: non-2xx status code 418
2025-05-14T04:25:39.248Z [container-agent] 2025-05-14 04:25:39 INFO juju-log Unable to connect to endpoint='nova-api-mysql-router-service.openstack.svc.cluster.local:6446'
2025-05-14T04:25:39.759Z [container-agent] 2025-05-14 04:25:39 INFO juju-log Enabling MySQL Router service
2025-05-14T04:25:43.649Z [container-agent] 2025-05-14 04:25:43 ERROR juju-log Failed to run MySQL Shell script:
2025-05-14T04:25:43.649Z [container-agent] import json
2025-05-14T04:25:43.649Z [container-agent] import mysqlsh
2025-05-14T04:25:43.649Z [container-agent] import traceback
2025-05-14T04:25:43.649Z [container-agent] 
2025-05-14T04:25:43.649Z [container-agent] try:
2025-05-14T04:25:43.649Z [container-agent]     # Disable wizards in this script, since it will be invoked without --no-wizard
2025-05-14T04:25:43.649Z [container-agent]     shell.options.set('useWizards', False)
2025-05-14T04:25:43.649Z [container-agent]     import json
2025-05-14T04:25:43.649Z [container-agent] 
2025-05-14T04:25:43.649Z [container-agent]     result = session.run_sql(
2025-05-14T04:25:43.649Z [container-agent]         "SELECT USER, ATTRIBUTE->>'$.router_id' FROM INFORMATION_SCHEMA.USER_ATTRIBUTES WHERE ATTRIBUTE->'$.created_by_user'='relation-105_ee070cdf4b8b4' AND ATTRIBUTE->'$.created_by_juju_unit'='nova-api-mysql-router/0'"
2025-05-14T04:25:43.649Z [container-agent]     )
2025-05-14T04:25:43.649Z [container-agent]     rows = result.fetch_all()
2025-05-14T04:25:43.649Z [container-agent]     # mysqlsh objects are weirdâ€”they quack (i.e. duck typing) like standard Python objects (e.g. list,
2025-05-14T04:25:43.649Z [container-agent]     # dict), but do not serialize to JSON correctly.
2025-05-14T04:25:43.649Z [container-agent]     # Cast to str & load from JSON str before serializing
2025-05-14T04:25:43.649Z [container-agent]     rows = json.loads(str(rows))
2025-05-14T04:25:43.649Z [container-agent]     with open("/tmp/mysqlsh_output.json", "w") as file:
2025-05-14T04:25:43.649Z [container-agent]         json.dump(rows, file)
2025-05-14T04:25:43.649Z [container-agent] except mysqlsh.DBError as exception:
2025-05-14T04:25:43.649Z [container-agent]     error = {
2025-05-14T04:25:43.649Z [container-agent]         "message": str(exception),
2025-05-14T04:25:43.649Z [container-agent]         "code": exception.code,
2025-05-14T04:25:43.649Z [container-agent]         "traceback_message": "".join(traceback.format_exception(exception)),
2025-05-14T04:25:43.649Z [container-agent]     }
2025-05-14T04:25:43.649Z [container-agent] else:
2025-05-14T04:25:43.649Z [container-agent]     error = None
2025-05-14T04:25:43.649Z [container-agent] with open("/tmp/mysqlsh_error.json", "w") as file:
2025-05-14T04:25:43.649Z [container-agent]     json.dump(error, file)
2025-05-14T04:25:43.649Z [container-agent] 
2025-05-14T04:25:43.649Z [container-agent] stderr:
2025-05-14T04:25:43.649Z [container-agent] Cannot set LC_ALL to locale en_US.UTF-8: No such file or directory
2025-05-14T04:25:43.649Z [container-agent] MySQL Error 2003 (HY000): Can't connect to MySQL server on 'mysql-primary.openstack.svc.cluster.local:3306' (1)
2025-05-14T04:25:43.649Z [container-agent] 
2025-05-14T04:25:43.649Z [container-agent] Traceback (most recent call last):
2025-05-14T04:25:43.649Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/src/rock.py", line 245, in _run_command
2025-05-14T04:25:43.649Z [container-agent]     output, _ = process.wait_output()
2025-05-14T04:25:43.649Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/venv/lib/python3.10/site-packages/ops/pebble.py", line 1441, in wait_output
2025-05-14T04:25:43.649Z [container-agent]     raise ExecError[AnyStr](self._command, exit_code, out_value, err_value)
2025-05-14T04:25:43.649Z [container-agent] ops.pebble.ExecError: non-zero exit code 1 executing ['mysqlsh', '--passwords-from-stdin', '--uri', 'relation-105_ee070cdf4b8b4@mysql-primary.openstack.svc.cluster.local:3306', '--python', '--file', '/tmp/mysqlsh_script.py'], stdout="\x1b[1mPlease provide the password for 'relation-105_ee070cdf4b8b4@mysql-primary.openstack.svc.cluster.local:3306': \x1b[0m", stderr="Cannot set LC_ALL to locale en_US.UTF-8: No such file or directory\nMySQL Error 2003 (HY000): Can't connect to MySQL server on 'mysql-primary.openstack.svc.cluster.local:3306' (1)\n"
2025-05-14T04:25:43.649Z [container-agent] 
2025-05-14T04:25:43.649Z [container-agent] During handling of the above exception, another exception occurred:
2025-05-14T04:25:43.649Z [container-agent] 
2025-05-14T04:25:43.649Z [container-agent] Traceback (most recent call last):
2025-05-14T04:25:43.649Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/src/mysql_shell/__init__.py", line 74, in _run_code
2025-05-14T04:25:43.650Z [container-agent]     self._container.run_mysql_shell(
2025-05-14T04:25:43.650Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/lib/charms/tempo_coordinator_k8s/v0/charm_tracing.py", line 735, in wrapped_function
2025-05-14T04:25:43.650Z [container-agent]     return callable(*args, **kwargs)  # type: ignore
2025-05-14T04:25:43.650Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/src/container.py", line 212, in run_mysql_shell
2025-05-14T04:25:43.650Z [container-agent]     return self._run_command(args, timeout=timeout, input=input)
2025-05-14T04:25:43.650Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/lib/charms/tempo_coordinator_k8s/v0/charm_tracing.py", line 735, in wrapped_function
2025-05-14T04:25:43.650Z [container-agent]     return callable(*args, **kwargs)  # type: ignore
2025-05-14T04:25:43.650Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/src/rock.py", line 247, in _run_command
2025-05-14T04:25:43.650Z [container-agent]     raise container.CalledProcessError(
2025-05-14T04:25:43.650Z [container-agent] container.CalledProcessError: Command '['mysqlsh', '--passwords-from-stdin', '--uri', 'relation-105_ee070cdf4b8b4@mysql-primary.openstack.svc.cluster.local:3306', '--python', '--file', '/tmp/mysqlsh_script.py']' returned non-zero exit status 1.
2025-05-14T04:25:43.940Z [container-agent] 2025-05-14 04:25:43 ERROR juju-log Uncaught exception while in charm code:
2025-05-14T04:25:43.940Z [container-agent] Traceback (most recent call last):
2025-05-14T04:25:43.940Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/src/rock.py", line 245, in _run_command
2025-05-14T04:25:43.940Z [container-agent]     output, _ = process.wait_output()
2025-05-14T04:25:43.940Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/venv/lib/python3.10/site-packages/ops/pebble.py", line 1441, in wait_output
2025-05-14T04:25:43.940Z [container-agent]     raise ExecError[AnyStr](self._command, exit_code, out_value, err_value)
2025-05-14T04:25:43.940Z [container-agent] ops.pebble.ExecError: non-zero exit code 1 executing ['mysqlsh', '--passwords-from-stdin', '--uri', 'relation-105_ee070cdf4b8b4@mysql-primary.openstack.svc.cluster.local:3306', '--python', '--file', '/tmp/mysqlsh_script.py'], stdout="\x1b[1mPlease provide the password for 'relation-105_ee070cdf4b8b4@mysql-primary.openstack.svc.cluster.local:3306': \x1b[0m", stderr="Cannot set LC_ALL to locale en_US.UTF-8: No such file or directory\nMySQL Error 2003 (HY000): Can't connect to MySQL server on 'mysql-primary.openstack.svc.cluster.local:3306' (1)\n"
2025-05-14T04:25:43.940Z [container-agent] 
2025-05-14T04:25:43.940Z [container-agent] During handling of the above exception, another exception occurred:
2025-05-14T04:25:43.940Z [container-agent] 
2025-05-14T04:25:43.940Z [container-agent] Traceback (most recent call last):
2025-05-14T04:25:43.940Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/src/charm.py", line 448, in <module>
2025-05-14T04:25:43.940Z [container-agent]     ops.main.main(KubernetesRouterCharm)
2025-05-14T04:25:43.940Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/venv/lib/python3.10/site-packages/ops/main.py", line 436, in main
2025-05-14T04:25:43.940Z [container-agent]     _emit_charm_event(charm, dispatcher.event_name)
2025-05-14T04:25:43.940Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/venv/lib/python3.10/site-packages/ops/main.py", line 144, in _emit_charm_event
2025-05-14T04:25:43.940Z [container-agent]     event_to_emit.emit(*args, **kwargs)
2025-05-14T04:25:43.940Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/venv/lib/python3.10/site-packages/ops/framework.py", line 351, in emit
2025-05-14T04:25:43.940Z [container-agent]     framework._emit(event)
2025-05-14T04:25:43.940Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/venv/lib/python3.10/site-packages/ops/framework.py", line 853, in _emit
2025-05-14T04:25:43.940Z [container-agent]     self._reemit(event_path)
2025-05-14T04:25:43.940Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/venv/lib/python3.10/site-packages/ops/framework.py", line 942, in _reemit
2025-05-14T04:25:43.940Z [container-agent]     custom_handler(event)
2025-05-14T04:25:43.940Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/lib/charms/tempo_coordinator_k8s/v0/charm_tracing.py", line 735, in wrapped_function
2025-05-14T04:25:43.940Z [container-agent]     return callable(*args, **kwargs)  # type: ignore
2025-05-14T04:25:43.940Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/src/abstract_charm.py", line 355, in reconcile
2025-05-14T04:25:43.940Z [container-agent]     workload_.reconcile(
2025-05-14T04:25:43.940Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/lib/charms/tempo_coordinator_k8s/v0/charm_tracing.py", line 735, in wrapped_function
2025-05-14T04:25:43.940Z [container-agent]     return callable(*args, **kwargs)  # type: ignore
2025-05-14T04:25:43.940Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/src/workload.py", line 399, in reconcile
2025-05-14T04:25:43.940Z [container-agent]     self._enable_router(event=event, tls=tls, unit_name=unit_name)
2025-05-14T04:25:43.940Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/lib/charms/tempo_coordinator_k8s/v0/charm_tracing.py", line 735, in wrapped_function
2025-05-14T04:25:43.940Z [container-agent]     return callable(*args, **kwargs)  # type: ignore
2025-05-14T04:25:43.940Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/src/workload.py", line 331, in _enable_router
2025-05-14T04:25:43.940Z [container-agent]     self._cleanup_after_upgrade_or_potential_container_restart()
2025-05-14T04:25:43.940Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/lib/charms/tempo_coordinator_k8s/v0/charm_tracing.py", line 735, in wrapped_function
2025-05-14T04:25:43.940Z [container-agent]     return callable(*args, **kwargs)  # type: ignore
2025-05-14T04:25:43.940Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/src/workload.py", line 228, in _cleanup_after_upgrade_or_potential_container_restart
2025-05-14T04:25:43.940Z [container-agent]     if user_info := self.shell.get_mysql_router_user_for_unit(self._charm.unit.name):
2025-05-14T04:25:43.940Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/src/mysql_shell/__init__.py", line 167, in get_mysql_router_user_for_unit
2025-05-14T04:25:43.940Z [container-agent]     self._run_code(
2025-05-14T04:25:43.940Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/src/mysql_shell/__init__.py", line 74, in _run_code
2025-05-14T04:25:43.940Z [container-agent]     self._container.run_mysql_shell(
2025-05-14T04:25:43.940Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/lib/charms/tempo_coordinator_k8s/v0/charm_tracing.py", line 735, in wrapped_function
2025-05-14T04:25:43.940Z [container-agent]     return callable(*args, **kwargs)  # type: ignore
2025-05-14T04:25:43.940Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/src/container.py", line 212, in run_mysql_shell
2025-05-14T04:25:43.940Z [container-agent]     return self._run_command(args, timeout=timeout, input=input)
2025-05-14T04:25:43.940Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/lib/charms/tempo_coordinator_k8s/v0/charm_tracing.py", line 735, in wrapped_function
2025-05-14T04:25:43.940Z [container-agent]     return callable(*args, **kwargs)  # type: ignore
2025-05-14T04:25:43.940Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/src/rock.py", line 247, in _run_command
2025-05-14T04:25:43.940Z [container-agent]     raise container.CalledProcessError(
2025-05-14T04:25:43.940Z [container-agent] container.CalledProcessError: Command '['mysqlsh', '--passwords-from-stdin', '--uri', 'relation-105_ee070cdf4b8b4@mysql-primary.openstack.svc.cluster.local:3306', '--python', '--file', '/tmp/mysqlsh_script.py']' returned non-zero exit status 1.
2025-05-14T04:25:44.340Z [pebble] Check "readiness" failure 6/3: non-2xx status code 418
2025-05-14T04:25:46.077Z [container-agent] 2025-05-14 04:25:46 ERROR juju.worker.uniter.operation runhook.go:180 hook "start" (via hook dispatching script: dispatch) failed: exit status 1
2025-05-14T04:25:46.085Z [container-agent] 2025-05-14 04:25:46 INFO juju.worker.uniter resolver.go:180 awaiting error resolution for "start" hook
2025-05-14T04:25:51.126Z [container-agent] 2025-05-14 04:25:51 INFO juju.worker.uniter resolver.go:180 awaiting error resolution for "start" hook
2025-05-14T04:25:54.343Z [pebble] Check "readiness" failure 7/3: non-2xx status code 418
2025-05-14T04:26:04.341Z [pebble] Check "readiness" failure 8/3: non-2xx status code 418
2025-05-14T04:26:05.815Z [container-agent] 2025-05-14 04:26:05 INFO juju-log Unable to connect to endpoint='nova-api-mysql-router-service.openstack.svc.cluster.local:6446'
2025-05-14T04:26:06.099Z [container-agent] 2025-05-14 04:26:06 INFO juju-log Enabling MySQL Router service
2025-05-14T04:26:12.477Z [container-agent] 2025-05-14 04:26:12 ERROR juju-log Failed to run MySQL Shell script:
2025-05-14T04:26:12.477Z [container-agent] import json
2025-05-14T04:26:12.477Z [container-agent] import mysqlsh
2025-05-14T04:26:12.477Z [container-agent] import traceback
2025-05-14T04:26:12.477Z [container-agent] 
2025-05-14T04:26:12.477Z [container-agent] try:
2025-05-14T04:26:12.477Z [container-agent]     # Disable wizards in this script, since it will be invoked without --no-wizard
2025-05-14T04:26:12.477Z [container-agent]     shell.options.set('useWizards', False)
2025-05-14T04:26:12.477Z [container-agent]     session.run_sql("DROP USER `mysql_router2_bi74gzv`")
2025-05-14T04:26:12.477Z [container-agent] 
2025-05-14T04:26:12.477Z [container-agent] except mysqlsh.DBError as exception:
2025-05-14T04:26:12.477Z [container-agent]     error = {
2025-05-14T04:26:12.477Z [container-agent]         "message": str(exception),
2025-05-14T04:26:12.477Z [container-agent]         "code": exception.code,
2025-05-14T04:26:12.477Z [container-agent]         "traceback_message": "".join(traceback.format_exception(exception)),
2025-05-14T04:26:12.477Z [container-agent]     }
2025-05-14T04:26:12.477Z [container-agent] else:
2025-05-14T04:26:12.477Z [container-agent]     error = None
2025-05-14T04:26:12.477Z [container-agent] with open("/tmp/mysqlsh_error.json", "w") as file:
2025-05-14T04:26:12.477Z [container-agent]     json.dump(error, file)
2025-05-14T04:26:12.477Z [container-agent] 
2025-05-14T04:26:12.477Z [container-agent] MySQL client error 1290
2025-05-14T04:26:12.477Z [container-agent] MySQL Shell traceback:
2025-05-14T04:26:12.477Z [container-agent] Traceback (most recent call last):
2025-05-14T04:26:12.477Z [container-agent]   File "<string>", line 8, in <module>
2025-05-14T04:26:12.477Z [container-agent] mysqlsh.DBError: MySQL Error (1290): ClassicSession.run_sql: The MySQL server is running with the --super-read-only option so it cannot execute this statement
2025-05-14T04:26:12.477Z [container-agent] 
2025-05-14T04:26:12.477Z [container-agent] Traceback (most recent call last):
2025-05-14T04:26:12.477Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/src/mysql_shell/__init__.py", line 99, in _run_code
2025-05-14T04:26:12.477Z [container-agent]     raise ShellDBError(**exception)
2025-05-14T04:26:12.477Z [container-agent] mysql_shell.ShellDBError: MySQL Error (1290): ClassicSession.run_sql: The MySQL server is running with the --super-read-only option so it cannot execute this statement
2025-05-14T04:26:12.680Z [container-agent] 2025-05-14 04:26:12 ERROR juju-log Uncaught exception while in charm code:
2025-05-14T04:26:12.685Z [container-agent] Traceback (most recent call last):
2025-05-14T04:26:12.685Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/src/charm.py", line 448, in <module>
2025-05-14T04:26:12.685Z [container-agent]     ops.main.main(KubernetesRouterCharm)
2025-05-14T04:26:12.685Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/venv/lib/python3.10/site-packages/ops/main.py", line 436, in main
2025-05-14T04:26:12.685Z [container-agent]     _emit_charm_event(charm, dispatcher.event_name)
2025-05-14T04:26:12.685Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/venv/lib/python3.10/site-packages/ops/main.py", line 144, in _emit_charm_event
2025-05-14T04:26:12.685Z [container-agent]     event_to_emit.emit(*args, **kwargs)
2025-05-14T04:26:12.685Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/venv/lib/python3.10/site-packages/ops/framework.py", line 351, in emit
2025-05-14T04:26:12.685Z [container-agent]     framework._emit(event)
2025-05-14T04:26:12.685Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/venv/lib/python3.10/site-packages/ops/framework.py", line 853, in _emit
2025-05-14T04:26:12.685Z [container-agent]     self._reemit(event_path)
2025-05-14T04:26:12.685Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/venv/lib/python3.10/site-packages/ops/framework.py", line 942, in _reemit
2025-05-14T04:26:12.685Z [container-agent]     custom_handler(event)
2025-05-14T04:26:12.685Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/lib/charms/tempo_coordinator_k8s/v0/charm_tracing.py", line 735, in wrapped_function
2025-05-14T04:26:12.685Z [container-agent]     return callable(*args, **kwargs)  # type: ignore
2025-05-14T04:26:12.685Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/src/abstract_charm.py", line 355, in reconcile
2025-05-14T04:26:12.685Z [container-agent]     workload_.reconcile(
2025-05-14T04:26:12.685Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/lib/charms/tempo_coordinator_k8s/v0/charm_tracing.py", line 735, in wrapped_function
2025-05-14T04:26:12.685Z [container-agent]     return callable(*args, **kwargs)  # type: ignore
2025-05-14T04:26:12.685Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/src/workload.py", line 399, in reconcile
2025-05-14T04:26:12.685Z [container-agent]     self._enable_router(event=event, tls=tls, unit_name=unit_name)
2025-05-14T04:26:12.685Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/lib/charms/tempo_coordinator_k8s/v0/charm_tracing.py", line 735, in wrapped_function
2025-05-14T04:26:12.692Z [container-agent]     return callable(*args, **kwargs)  # type: ignore
2025-05-14T04:26:12.692Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/src/workload.py", line 331, in _enable_router
2025-05-14T04:26:12.692Z [container-agent]     self._cleanup_after_upgrade_or_potential_container_restart()
2025-05-14T04:26:12.692Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/lib/charms/tempo_coordinator_k8s/v0/charm_tracing.py", line 735, in wrapped_function
2025-05-14T04:26:12.692Z [container-agent]     return callable(*args, **kwargs)  # type: ignore
2025-05-14T04:26:12.692Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/src/workload.py", line 230, in _cleanup_after_upgrade_or_potential_container_restart
2025-05-14T04:26:12.692Z [container-agent]     self.shell.delete_user(user_info.username)
2025-05-14T04:26:12.692Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/src/mysql_shell/__init__.py", line 207, in delete_user
2025-05-14T04:26:12.692Z [container-agent]     self._run_sql([statement])
2025-05-14T04:26:12.692Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/src/mysql_shell/__init__.py", line 113, in _run_sql
2025-05-14T04:26:12.692Z [container-agent]     self._run_code(
2025-05-14T04:26:12.692Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/src/mysql_shell/__init__.py", line 99, in _run_code
2025-05-14T04:26:12.692Z [container-agent]     raise ShellDBError(**exception)
2025-05-14T04:26:12.692Z [container-agent] mysql_shell.ShellDBError: MySQL Error (1290): ClassicSession.run_sql: The MySQL server is running with the --super-read-only option so it cannot execute this statement
2025-05-14T04:26:14.104Z [container-agent] 2025-05-14 04:26:14 ERROR juju.worker.uniter.operation runhook.go:180 hook "start" (via hook dispatching script: dispatch) failed: exit status 1
2025-05-14T04:26:14.110Z [container-agent] 2025-05-14 04:26:14 INFO juju.worker.uniter resolver.go:180 awaiting error resolution for "start" hook
2025-05-14T04:26:14.347Z [pebble] Check "readiness" failure 9/3: non-2xx status code 418
2025-05-14T04:26:24.185Z [container-agent] 2025-05-14 04:26:24 INFO juju.worker.uniter resolver.go:180 awaiting error resolution for "start" hook
2025-05-14T04:26:24.333Z [pebble] Check "readiness" failure 10/3: non-2xx status code 418
2025-05-14T04:26:34.395Z [pebble] Check "readiness" failure 11/3: non-2xx status code 418
2025-05-14T04:26:37.112Z [container-agent] 2025-05-14 04:26:37 INFO juju-log Unable to connect to endpoint='nova-api-mysql-router-service.openstack.svc.cluster.local:6446'
2025-05-14T04:26:37.333Z [container-agent] 2025-05-14 04:26:37 INFO juju-log Enabling MySQL Router service
2025-05-14T04:26:43.285Z [container-agent] 2025-05-14 04:26:43 ERROR juju-log Failed to run MySQL Shell script:
2025-05-14T04:26:43.285Z [container-agent] import json
2025-05-14T04:26:43.285Z [container-agent] import mysqlsh
2025-05-14T04:26:43.285Z [container-agent] import traceback
2025-05-14T04:26:43.285Z [container-agent] 
2025-05-14T04:26:43.285Z [container-agent] try:
2025-05-14T04:26:43.285Z [container-agent]     # Disable wizards in this script, since it will be invoked without --no-wizard
2025-05-14T04:26:43.285Z [container-agent]     shell.options.set('useWizards', False)
2025-05-14T04:26:43.285Z [container-agent]     session.run_sql("DROP USER `mysql_router2_bi74gzv`")
2025-05-14T04:26:43.285Z [container-agent] 
2025-05-14T04:26:43.285Z [container-agent] except mysqlsh.DBError as exception:
2025-05-14T04:26:43.285Z [container-agent]     error = {
2025-05-14T04:26:43.285Z [container-agent]         "message": str(exception),
2025-05-14T04:26:43.285Z [container-agent]         "code": exception.code,
2025-05-14T04:26:43.285Z [container-agent]         "traceback_message": "".join(traceback.format_exception(exception)),
2025-05-14T04:26:43.285Z [container-agent]     }
2025-05-14T04:26:43.285Z [container-agent] else:
2025-05-14T04:26:43.285Z [container-agent]     error = None
2025-05-14T04:26:43.285Z [container-agent] with open("/tmp/mysqlsh_error.json", "w") as file:
2025-05-14T04:26:43.285Z [container-agent]     json.dump(error, file)
2025-05-14T04:26:43.285Z [container-agent] 
2025-05-14T04:26:43.285Z [container-agent] MySQL client error 1290
2025-05-14T04:26:43.285Z [container-agent] MySQL Shell traceback:
2025-05-14T04:26:43.285Z [container-agent] Traceback (most recent call last):
2025-05-14T04:26:43.285Z [container-agent]   File "<string>", line 8, in <module>
2025-05-14T04:26:43.285Z [container-agent] mysqlsh.DBError: MySQL Error (1290): ClassicSession.run_sql: The MySQL server is running with the --super-read-only option so it cannot execute this statement
2025-05-14T04:26:43.285Z [container-agent] 
2025-05-14T04:26:43.285Z [container-agent] Traceback (most recent call last):
2025-05-14T04:26:43.285Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/src/mysql_shell/__init__.py", line 99, in _run_code
2025-05-14T04:26:43.285Z [container-agent]     raise ShellDBError(**exception)
2025-05-14T04:26:43.285Z [container-agent] mysql_shell.ShellDBError: MySQL Error (1290): ClassicSession.run_sql: The MySQL server is running with the --super-read-only option so it cannot execute this statement
2025-05-14T04:26:43.396Z [container-agent] 2025-05-14 04:26:43 ERROR juju-log Uncaught exception while in charm code:
2025-05-14T04:26:43.397Z [container-agent] Traceback (most recent call last):
2025-05-14T04:26:43.397Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/src/charm.py", line 448, in <module>
2025-05-14T04:26:43.397Z [container-agent]     ops.main.main(KubernetesRouterCharm)
2025-05-14T04:26:43.397Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/venv/lib/python3.10/site-packages/ops/main.py", line 436, in main
2025-05-14T04:26:43.397Z [container-agent]     _emit_charm_event(charm, dispatcher.event_name)
2025-05-14T04:26:43.397Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/venv/lib/python3.10/site-packages/ops/main.py", line 144, in _emit_charm_event
2025-05-14T04:26:43.397Z [container-agent]     event_to_emit.emit(*args, **kwargs)
2025-05-14T04:26:43.397Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/venv/lib/python3.10/site-packages/ops/framework.py", line 351, in emit
2025-05-14T04:26:43.397Z [container-agent]     framework._emit(event)
2025-05-14T04:26:43.397Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/venv/lib/python3.10/site-packages/ops/framework.py", line 853, in _emit
2025-05-14T04:26:43.397Z [container-agent]     self._reemit(event_path)
2025-05-14T04:26:43.397Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/venv/lib/python3.10/site-packages/ops/framework.py", line 942, in _reemit
2025-05-14T04:26:43.397Z [container-agent]     custom_handler(event)
2025-05-14T04:26:43.397Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/lib/charms/tempo_coordinator_k8s/v0/charm_tracing.py", line 735, in wrapped_function
2025-05-14T04:26:43.397Z [container-agent]     return callable(*args, **kwargs)  # type: ignore
2025-05-14T04:26:43.397Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/src/abstract_charm.py", line 355, in reconcile
2025-05-14T04:26:43.397Z [container-agent]     workload_.reconcile(
2025-05-14T04:26:43.397Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/lib/charms/tempo_coordinator_k8s/v0/charm_tracing.py", line 735, in wrapped_function
2025-05-14T04:26:43.397Z [container-agent]     return callable(*args, **kwargs)  # type: ignore
2025-05-14T04:26:43.397Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/src/workload.py", line 399, in reconcile
2025-05-14T04:26:43.397Z [container-agent]     self._enable_router(event=event, tls=tls, unit_name=unit_name)
2025-05-14T04:26:43.397Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/lib/charms/tempo_coordinator_k8s/v0/charm_tracing.py", line 735, in wrapped_function
2025-05-14T04:26:43.397Z [container-agent]     return callable(*args, **kwargs)  # type: ignore
2025-05-14T04:26:43.397Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/src/workload.py", line 331, in _enable_router
2025-05-14T04:26:43.397Z [container-agent]     self._cleanup_after_upgrade_or_potential_container_restart()
2025-05-14T04:26:43.397Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/lib/charms/tempo_coordinator_k8s/v0/charm_tracing.py", line 735, in wrapped_function
2025-05-14T04:26:43.397Z [container-agent]     return callable(*args, **kwargs)  # type: ignore
2025-05-14T04:26:43.397Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/src/workload.py", line 230, in _cleanup_after_upgrade_or_potential_container_restart
2025-05-14T04:26:43.397Z [container-agent]     self.shell.delete_user(user_info.username)
2025-05-14T04:26:43.397Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/src/mysql_shell/__init__.py", line 207, in delete_user
2025-05-14T04:26:43.397Z [container-agent]     self._run_sql([statement])
2025-05-14T04:26:43.397Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/src/mysql_shell/__init__.py", line 113, in _run_sql
2025-05-14T04:26:43.397Z [container-agent]     self._run_code(
2025-05-14T04:26:43.399Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/src/mysql_shell/__init__.py", line 99, in _run_code
2025-05-14T04:26:43.399Z [container-agent]     raise ShellDBError(**exception)
2025-05-14T04:26:43.399Z [container-agent] mysql_shell.ShellDBError: MySQL Error (1290): ClassicSession.run_sql: The MySQL server is running with the --super-read-only option so it cannot execute this statement
2025-05-14T04:26:44.409Z [pebble] Check "readiness" failure 12/3: non-2xx status code 418
2025-05-14T04:26:44.850Z [container-agent] 2025-05-14 04:26:44 ERROR juju.worker.uniter.operation runhook.go:180 hook "start" (via hook dispatching script: dispatch) failed: exit status 1
2025-05-14T04:26:44.850Z [container-agent] 2025-05-14 04:26:44 INFO juju.worker.uniter resolver.go:180 awaiting error resolution for "start" hook
2025-05-14T04:26:54.356Z [pebble] Check "readiness" failure 13/3: non-2xx status code 418
2025-05-14T04:27:04.331Z [pebble] Check "readiness" failure 14/3: non-2xx status code 418
2025-05-14T04:27:04.861Z [container-agent] 2025-05-14 04:27:04 INFO juju.worker.uniter resolver.go:180 awaiting error resolution for "start" hook
2025-05-14T04:27:14.412Z [pebble] Check "readiness" failure 15/3: non-2xx status code 418
2025-05-14T04:27:14.564Z [container-agent] 2025-05-14 04:27:14 INFO juju-log Unable to connect to endpoint='nova-api-mysql-router-service.openstack.svc.cluster.local:6446'
2025-05-14T04:27:14.946Z [container-agent] 2025-05-14 04:27:14 INFO juju-log Enabling MySQL Router service
2025-05-14T04:27:19.567Z [container-agent] 2025-05-14 04:27:19 ERROR juju-log Failed to run MySQL Shell script:
2025-05-14T04:27:19.567Z [container-agent] import json
2025-05-14T04:27:19.567Z [container-agent] import mysqlsh
2025-05-14T04:27:19.567Z [container-agent] import traceback
2025-05-14T04:27:19.567Z [container-agent] 
2025-05-14T04:27:19.567Z [container-agent] try:
2025-05-14T04:27:19.567Z [container-agent]     # Disable wizards in this script, since it will be invoked without --no-wizard
2025-05-14T04:27:19.567Z [container-agent]     shell.options.set('useWizards', False)
2025-05-14T04:27:19.567Z [container-agent]     session.run_sql("DROP USER `mysql_router2_bi74gzv`")
2025-05-14T04:27:19.567Z [container-agent] 
2025-05-14T04:27:19.567Z [container-agent] except mysqlsh.DBError as exception:
2025-05-14T04:27:19.567Z [container-agent]     error = {
2025-05-14T04:27:19.567Z [container-agent]         "message": str(exception),
2025-05-14T04:27:19.567Z [container-agent]         "code": exception.code,
2025-05-14T04:27:19.567Z [container-agent]         "traceback_message": "".join(traceback.format_exception(exception)),
2025-05-14T04:27:19.567Z [container-agent]     }
2025-05-14T04:27:19.567Z [container-agent] else:
2025-05-14T04:27:19.567Z [container-agent]     error = None
2025-05-14T04:27:19.567Z [container-agent] with open("/tmp/mysqlsh_error.json", "w") as file:
2025-05-14T04:27:19.567Z [container-agent]     json.dump(error, file)
2025-05-14T04:27:19.567Z [container-agent] 
2025-05-14T04:27:19.567Z [container-agent] MySQL client error 1290
2025-05-14T04:27:19.567Z [container-agent] MySQL Shell traceback:
2025-05-14T04:27:19.567Z [container-agent] Traceback (most recent call last):
2025-05-14T04:27:19.567Z [container-agent]   File "<string>", line 8, in <module>
2025-05-14T04:27:19.567Z [container-agent] mysqlsh.DBError: MySQL Error (1290): ClassicSession.run_sql: The MySQL server is running with the --super-read-only option so it cannot execute this statement
2025-05-14T04:27:19.567Z [container-agent] 
2025-05-14T04:27:19.567Z [container-agent] Traceback (most recent call last):
2025-05-14T04:27:19.567Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/src/mysql_shell/__init__.py", line 99, in _run_code
2025-05-14T04:27:19.567Z [container-agent]     raise ShellDBError(**exception)
2025-05-14T04:27:19.567Z [container-agent] mysql_shell.ShellDBError: MySQL Error (1290): ClassicSession.run_sql: The MySQL server is running with the --super-read-only option so it cannot execute this statement
2025-05-14T04:27:19.678Z [container-agent] 2025-05-14 04:27:19 ERROR juju-log Uncaught exception while in charm code:
2025-05-14T04:27:19.678Z [container-agent] Traceback (most recent call last):
2025-05-14T04:27:19.678Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/src/charm.py", line 448, in <module>
2025-05-14T04:27:19.678Z [container-agent]     ops.main.main(KubernetesRouterCharm)
2025-05-14T04:27:19.678Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/venv/lib/python3.10/site-packages/ops/main.py", line 436, in main
2025-05-14T04:27:19.678Z [container-agent]     _emit_charm_event(charm, dispatcher.event_name)
2025-05-14T04:27:19.678Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/venv/lib/python3.10/site-packages/ops/main.py", line 144, in _emit_charm_event
2025-05-14T04:27:19.678Z [container-agent]     event_to_emit.emit(*args, **kwargs)
2025-05-14T04:27:19.678Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/venv/lib/python3.10/site-packages/ops/framework.py", line 351, in emit
2025-05-14T04:27:19.678Z [container-agent]     framework._emit(event)
2025-05-14T04:27:19.678Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/venv/lib/python3.10/site-packages/ops/framework.py", line 853, in _emit
2025-05-14T04:27:19.678Z [container-agent]     self._reemit(event_path)
2025-05-14T04:27:19.678Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/venv/lib/python3.10/site-packages/ops/framework.py", line 942, in _reemit
2025-05-14T04:27:19.678Z [container-agent]     custom_handler(event)
2025-05-14T04:27:19.678Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/lib/charms/tempo_coordinator_k8s/v0/charm_tracing.py", line 735, in wrapped_function
2025-05-14T04:27:19.678Z [container-agent]     return callable(*args, **kwargs)  # type: ignore
2025-05-14T04:27:19.678Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/src/abstract_charm.py", line 355, in reconcile
2025-05-14T04:27:19.678Z [container-agent]     workload_.reconcile(
2025-05-14T04:27:19.678Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/lib/charms/tempo_coordinator_k8s/v0/charm_tracing.py", line 735, in wrapped_function
2025-05-14T04:27:19.678Z [container-agent]     return callable(*args, **kwargs)  # type: ignore
2025-05-14T04:27:19.678Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/src/workload.py", line 399, in reconcile
2025-05-14T04:27:19.678Z [container-agent]     self._enable_router(event=event, tls=tls, unit_name=unit_name)
2025-05-14T04:27:19.678Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/lib/charms/tempo_coordinator_k8s/v0/charm_tracing.py", line 735, in wrapped_function
2025-05-14T04:27:19.678Z [container-agent]     return callable(*args, **kwargs)  # type: ignore
2025-05-14T04:27:19.678Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/src/workload.py", line 331, in _enable_router
2025-05-14T04:27:19.678Z [container-agent]     self._cleanup_after_upgrade_or_potential_container_restart()
2025-05-14T04:27:19.678Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/lib/charms/tempo_coordinator_k8s/v0/charm_tracing.py", line 735, in wrapped_function
2025-05-14T04:27:19.678Z [container-agent]     return callable(*args, **kwargs)  # type: ignore
2025-05-14T04:27:19.678Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/src/workload.py", line 230, in _cleanup_after_upgrade_or_potential_container_restart
2025-05-14T04:27:19.678Z [container-agent]     self.shell.delete_user(user_info.username)
2025-05-14T04:27:19.678Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/src/mysql_shell/__init__.py", line 207, in delete_user
2025-05-14T04:27:19.678Z [container-agent]     self._run_sql([statement])
2025-05-14T04:27:19.678Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/src/mysql_shell/__init__.py", line 113, in _run_sql
2025-05-14T04:27:19.678Z [container-agent]     self._run_code(
2025-05-14T04:27:19.678Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/src/mysql_shell/__init__.py", line 99, in _run_code
2025-05-14T04:27:19.678Z [container-agent]     raise ShellDBError(**exception)
2025-05-14T04:27:19.678Z [container-agent] mysql_shell.ShellDBError: MySQL Error (1290): ClassicSession.run_sql: The MySQL server is running with the --super-read-only option so it cannot execute this statement
2025-05-14T04:27:20.740Z [container-agent] 2025-05-14 04:27:20 ERROR juju.worker.uniter.operation runhook.go:180 hook "start" (via hook dispatching script: dispatch) failed: exit status 1
2025-05-14T04:27:20.779Z [container-agent] 2025-05-14 04:27:20 INFO juju.worker.uniter resolver.go:180 awaiting error resolution for "start" hook
2025-05-14T04:27:24.336Z [pebble] Check "readiness" failure 16/3: non-2xx status code 418
2025-05-14T04:27:34.310Z [pebble] Check "readiness" failure 17/3: non-2xx status code 418
2025-05-14T04:27:44.315Z [pebble] Check "readiness" failure 18/3: non-2xx status code 418
2025-05-14T04:27:54.397Z [pebble] Check "readiness" failure 19/3: non-2xx status code 418
2025-05-14T04:28:00.284Z [container-agent] 2025-05-14 04:28:00 INFO juju.worker.uniter resolver.go:180 awaiting error resolution for "start" hook
2025-05-14T04:28:00.346Z [container-agent] 2025-05-14 04:28:00 INFO juju.worker.uniter resolver.go:180 awaiting error resolution for "start" hook
2025-05-14T04:28:01.173Z [container-agent] 2025-05-14 04:28:01 INFO juju.worker.uniter resolver.go:180 awaiting error resolution for "start" hook
2025-05-14T04:28:04.323Z [pebble] Check "readiness" failure 20/3: non-2xx status code 418
2025-05-14T04:28:06.157Z [container-agent] 2025-05-14 04:28:06 INFO juju-log Unable to connect to endpoint='nova-api-mysql-router-service.openstack.svc.cluster.local:6446'
2025-05-14T04:28:06.223Z [container-agent] 2025-05-14 04:28:06 INFO juju-log Enabling MySQL Router service
2025-05-14T04:28:08.627Z [container-agent] 2025-05-14 04:28:08 ERROR juju-log Failed to run MySQL Shell script:
2025-05-14T04:28:08.628Z [container-agent] import json
2025-05-14T04:28:08.628Z [container-agent] import mysqlsh
2025-05-14T04:28:08.628Z [container-agent] import traceback
2025-05-14T04:28:08.628Z [container-agent] 
2025-05-14T04:28:08.628Z [container-agent] try:
2025-05-14T04:28:08.628Z [container-agent]     # Disable wizards in this script, since it will be invoked without --no-wizard
2025-05-14T04:28:08.628Z [container-agent]     shell.options.set('useWizards', False)
2025-05-14T04:28:08.628Z [container-agent]     session.run_sql("DROP USER `mysql_router2_bi74gzv`")
2025-05-14T04:28:08.628Z [container-agent] 
2025-05-14T04:28:08.628Z [container-agent] except mysqlsh.DBError as exception:
2025-05-14T04:28:08.628Z [container-agent]     error = {
2025-05-14T04:28:08.628Z [container-agent]         "message": str(exception),
2025-05-14T04:28:08.628Z [container-agent]         "code": exception.code,
2025-05-14T04:28:08.628Z [container-agent]         "traceback_message": "".join(traceback.format_exception(exception)),
2025-05-14T04:28:08.628Z [container-agent]     }
2025-05-14T04:28:08.628Z [container-agent] else:
2025-05-14T04:28:08.628Z [container-agent]     error = None
2025-05-14T04:28:08.628Z [container-agent] with open("/tmp/mysqlsh_error.json", "w") as file:
2025-05-14T04:28:08.628Z [container-agent]     json.dump(error, file)
2025-05-14T04:28:08.628Z [container-agent] 
2025-05-14T04:28:08.628Z [container-agent] MySQL client error 1290
2025-05-14T04:28:08.628Z [container-agent] MySQL Shell traceback:
2025-05-14T04:28:08.628Z [container-agent] Traceback (most recent call last):
2025-05-14T04:28:08.628Z [container-agent]   File "<string>", line 8, in <module>
2025-05-14T04:28:08.628Z [container-agent] mysqlsh.DBError: MySQL Error (1290): ClassicSession.run_sql: The MySQL server is running with the --super-read-only option so it cannot execute this statement
2025-05-14T04:28:08.628Z [container-agent] 
2025-05-14T04:28:08.628Z [container-agent] Traceback (most recent call last):
2025-05-14T04:28:08.628Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/src/mysql_shell/__init__.py", line 99, in _run_code
2025-05-14T04:28:08.628Z [container-agent]     raise ShellDBError(**exception)
2025-05-14T04:28:08.628Z [container-agent] mysql_shell.ShellDBError: MySQL Error (1290): ClassicSession.run_sql: The MySQL server is running with the --super-read-only option so it cannot execute this statement
2025-05-14T04:28:08.707Z [container-agent] 2025-05-14 04:28:08 ERROR juju-log Uncaught exception while in charm code:
2025-05-14T04:28:08.707Z [container-agent] Traceback (most recent call last):
2025-05-14T04:28:08.707Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/src/charm.py", line 448, in <module>
2025-05-14T04:28:08.707Z [container-agent]     ops.main.main(KubernetesRouterCharm)
2025-05-14T04:28:08.707Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/venv/lib/python3.10/site-packages/ops/main.py", line 436, in main
2025-05-14T04:28:08.707Z [container-agent]     _emit_charm_event(charm, dispatcher.event_name)
2025-05-14T04:28:08.707Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/venv/lib/python3.10/site-packages/ops/main.py", line 144, in _emit_charm_event
2025-05-14T04:28:08.707Z [container-agent]     event_to_emit.emit(*args, **kwargs)
2025-05-14T04:28:08.707Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/venv/lib/python3.10/site-packages/ops/framework.py", line 351, in emit
2025-05-14T04:28:08.707Z [container-agent]     framework._emit(event)
2025-05-14T04:28:08.707Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/venv/lib/python3.10/site-packages/ops/framework.py", line 853, in _emit
2025-05-14T04:28:08.707Z [container-agent]     self._reemit(event_path)
2025-05-14T04:28:08.707Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/venv/lib/python3.10/site-packages/ops/framework.py", line 942, in _reemit
2025-05-14T04:28:08.707Z [container-agent]     custom_handler(event)
2025-05-14T04:28:08.707Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/lib/charms/tempo_coordinator_k8s/v0/charm_tracing.py", line 735, in wrapped_function
2025-05-14T04:28:08.707Z [container-agent]     return callable(*args, **kwargs)  # type: ignore
2025-05-14T04:28:08.707Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/src/abstract_charm.py", line 355, in reconcile
2025-05-14T04:28:08.707Z [container-agent]     workload_.reconcile(
2025-05-14T04:28:08.707Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/lib/charms/tempo_coordinator_k8s/v0/charm_tracing.py", line 735, in wrapped_function
2025-05-14T04:28:08.707Z [container-agent]     return callable(*args, **kwargs)  # type: ignore
2025-05-14T04:28:08.707Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/src/workload.py", line 399, in reconcile
2025-05-14T04:28:08.707Z [container-agent]     self._enable_router(event=event, tls=tls, unit_name=unit_name)
2025-05-14T04:28:08.707Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/lib/charms/tempo_coordinator_k8s/v0/charm_tracing.py", line 735, in wrapped_function
2025-05-14T04:28:08.707Z [container-agent]     return callable(*args, **kwargs)  # type: ignore
2025-05-14T04:28:08.707Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/src/workload.py", line 331, in _enable_router
2025-05-14T04:28:08.707Z [container-agent]     self._cleanup_after_upgrade_or_potential_container_restart()
2025-05-14T04:28:08.707Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/lib/charms/tempo_coordinator_k8s/v0/charm_tracing.py", line 735, in wrapped_function
2025-05-14T04:28:08.707Z [container-agent]     return callable(*args, **kwargs)  # type: ignore
2025-05-14T04:28:08.707Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/src/workload.py", line 230, in _cleanup_after_upgrade_or_potential_container_restart
2025-05-14T04:28:08.707Z [container-agent]     self.shell.delete_user(user_info.username)
2025-05-14T04:28:08.707Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/src/mysql_shell/__init__.py", line 207, in delete_user
2025-05-14T04:28:08.707Z [container-agent]     self._run_sql([statement])
2025-05-14T04:28:08.707Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/src/mysql_shell/__init__.py", line 113, in _run_sql
2025-05-14T04:28:08.707Z [container-agent]     self._run_code(
2025-05-14T04:28:08.707Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/src/mysql_shell/__init__.py", line 99, in _run_code
2025-05-14T04:28:08.707Z [container-agent]     raise ShellDBError(**exception)
2025-05-14T04:28:08.707Z [container-agent] mysql_shell.ShellDBError: MySQL Error (1290): ClassicSession.run_sql: The MySQL server is running with the --super-read-only option so it cannot execute this statement
2025-05-14T04:28:09.747Z [container-agent] 2025-05-14 04:28:09 ERROR juju.worker.uniter.operation runhook.go:180 hook "start" (via hook dispatching script: dispatch) failed: exit status 1
2025-05-14T04:28:09.772Z [container-agent] 2025-05-14 04:28:09 INFO juju.worker.uniter resolver.go:180 awaiting error resolution for "start" hook
2025-05-14T04:28:14.314Z [pebble] Check "readiness" failure 21/3: non-2xx status code 418
2025-05-14T04:28:24.310Z [pebble] Check "readiness" failure 22/3: non-2xx status code 418
2025-05-14T04:28:34.306Z [pebble] Check "readiness" failure 23/3: non-2xx status code 418
2025-05-14T04:28:44.309Z [pebble] Check "readiness" failure 24/3: non-2xx status code 418
2025-05-14T04:28:54.319Z [pebble] Check "readiness" failure 25/3: non-2xx status code 418
2025-05-14T04:29:04.307Z [pebble] Check "readiness" failure 26/3: non-2xx status code 418
2025-05-14T04:29:14.308Z [pebble] Check "readiness" failure 27/3: non-2xx status code 418
2025-05-14T04:29:24.311Z [pebble] Check "readiness" failure 28/3: non-2xx status code 418
2025-05-14T04:29:31.427Z [container-agent] 2025-05-14 04:29:31 INFO juju.worker.uniter resolver.go:180 awaiting error resolution for "start" hook
2025-05-14T04:29:34.190Z [container-agent] 2025-05-14 04:29:34 INFO juju-log Unable to connect to endpoint='nova-api-mysql-router-service.openstack.svc.cluster.local:6446'
2025-05-14T04:29:34.254Z [container-agent] 2025-05-14 04:29:34 INFO juju-log Enabling MySQL Router service
2025-05-14T04:29:34.316Z [pebble] Check "readiness" failure 29/3: non-2xx status code 418
2025-05-14T04:29:35.493Z [container-agent] 2025-05-14 04:29:35 ERROR juju-log Failed to run MySQL Shell script:
2025-05-14T04:29:35.493Z [container-agent] import json
2025-05-14T04:29:35.493Z [container-agent] import mysqlsh
2025-05-14T04:29:35.493Z [container-agent] import traceback
2025-05-14T04:29:35.493Z [container-agent] 
2025-05-14T04:29:35.493Z [container-agent] try:
2025-05-14T04:29:35.493Z [container-agent]     # Disable wizards in this script, since it will be invoked without --no-wizard
2025-05-14T04:29:35.493Z [container-agent]     shell.options.set('useWizards', False)
2025-05-14T04:29:35.493Z [container-agent]     session.run_sql("DROP USER `mysql_router2_bi74gzv`")
2025-05-14T04:29:35.493Z [container-agent] 
2025-05-14T04:29:35.493Z [container-agent] except mysqlsh.DBError as exception:
2025-05-14T04:29:35.493Z [container-agent]     error = {
2025-05-14T04:29:35.493Z [container-agent]         "message": str(exception),
2025-05-14T04:29:35.493Z [container-agent]         "code": exception.code,
2025-05-14T04:29:35.493Z [container-agent]         "traceback_message": "".join(traceback.format_exception(exception)),
2025-05-14T04:29:35.493Z [container-agent]     }
2025-05-14T04:29:35.493Z [container-agent] else:
2025-05-14T04:29:35.493Z [container-agent]     error = None
2025-05-14T04:29:35.493Z [container-agent] with open("/tmp/mysqlsh_error.json", "w") as file:
2025-05-14T04:29:35.493Z [container-agent]     json.dump(error, file)
2025-05-14T04:29:35.493Z [container-agent] 
2025-05-14T04:29:35.493Z [container-agent] MySQL client error 1290
2025-05-14T04:29:35.493Z [container-agent] MySQL Shell traceback:
2025-05-14T04:29:35.493Z [container-agent] Traceback (most recent call last):
2025-05-14T04:29:35.493Z [container-agent]   File "<string>", line 8, in <module>
2025-05-14T04:29:35.493Z [container-agent] mysqlsh.DBError: MySQL Error (1290): ClassicSession.run_sql: The MySQL server is running with the --super-read-only option so it cannot execute this statement
2025-05-14T04:29:35.493Z [container-agent] 
2025-05-14T04:29:35.493Z [container-agent] Traceback (most recent call last):
2025-05-14T04:29:35.493Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/src/mysql_shell/__init__.py", line 99, in _run_code
2025-05-14T04:29:35.493Z [container-agent]     raise ShellDBError(**exception)
2025-05-14T04:29:35.493Z [container-agent] mysql_shell.ShellDBError: MySQL Error (1290): ClassicSession.run_sql: The MySQL server is running with the --super-read-only option so it cannot execute this statement
2025-05-14T04:29:35.509Z [container-agent] 2025-05-14 04:29:35 ERROR juju-log Uncaught exception while in charm code:
2025-05-14T04:29:35.510Z [container-agent] Traceback (most recent call last):
2025-05-14T04:29:35.510Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/src/charm.py", line 448, in <module>
2025-05-14T04:29:35.510Z [container-agent]     ops.main.main(KubernetesRouterCharm)
2025-05-14T04:29:35.510Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/venv/lib/python3.10/site-packages/ops/main.py", line 436, in main
2025-05-14T04:29:35.510Z [container-agent]     _emit_charm_event(charm, dispatcher.event_name)
2025-05-14T04:29:35.510Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/venv/lib/python3.10/site-packages/ops/main.py", line 144, in _emit_charm_event
2025-05-14T04:29:35.510Z [container-agent]     event_to_emit.emit(*args, **kwargs)
2025-05-14T04:29:35.510Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/venv/lib/python3.10/site-packages/ops/framework.py", line 351, in emit
2025-05-14T04:29:35.510Z [container-agent]     framework._emit(event)
2025-05-14T04:29:35.510Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/venv/lib/python3.10/site-packages/ops/framework.py", line 853, in _emit
2025-05-14T04:29:35.510Z [container-agent]     self._reemit(event_path)
2025-05-14T04:29:35.510Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/venv/lib/python3.10/site-packages/ops/framework.py", line 942, in _reemit
2025-05-14T04:29:35.510Z [container-agent]     custom_handler(event)
2025-05-14T04:29:35.510Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/lib/charms/tempo_coordinator_k8s/v0/charm_tracing.py", line 735, in wrapped_function
2025-05-14T04:29:35.510Z [container-agent]     return callable(*args, **kwargs)  # type: ignore
2025-05-14T04:29:35.510Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/src/abstract_charm.py", line 355, in reconcile
2025-05-14T04:29:35.510Z [container-agent]     workload_.reconcile(
2025-05-14T04:29:35.510Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/lib/charms/tempo_coordinator_k8s/v0/charm_tracing.py", line 735, in wrapped_function
2025-05-14T04:29:35.510Z [container-agent]     return callable(*args, **kwargs)  # type: ignore
2025-05-14T04:29:35.510Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/src/workload.py", line 399, in reconcile
2025-05-14T04:29:35.510Z [container-agent]     self._enable_router(event=event, tls=tls, unit_name=unit_name)
2025-05-14T04:29:35.510Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/lib/charms/tempo_coordinator_k8s/v0/charm_tracing.py", line 735, in wrapped_function
2025-05-14T04:29:35.510Z [container-agent]     return callable(*args, **kwargs)  # type: ignore
2025-05-14T04:29:35.510Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/src/workload.py", line 331, in _enable_router
2025-05-14T04:29:35.510Z [container-agent]     self._cleanup_after_upgrade_or_potential_container_restart()
2025-05-14T04:29:35.510Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/lib/charms/tempo_coordinator_k8s/v0/charm_tracing.py", line 735, in wrapped_function
2025-05-14T04:29:35.510Z [container-agent]     return callable(*args, **kwargs)  # type: ignore
2025-05-14T04:29:35.510Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/src/workload.py", line 230, in _cleanup_after_upgrade_or_potential_container_restart
2025-05-14T04:29:35.510Z [container-agent]     self.shell.delete_user(user_info.username)
2025-05-14T04:29:35.510Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/src/mysql_shell/__init__.py", line 207, in delete_user
2025-05-14T04:29:35.510Z [container-agent]     self._run_sql([statement])
2025-05-14T04:29:35.510Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/src/mysql_shell/__init__.py", line 113, in _run_sql
2025-05-14T04:29:35.510Z [container-agent]     self._run_code(
2025-05-14T04:29:35.510Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/src/mysql_shell/__init__.py", line 99, in _run_code
2025-05-14T04:29:35.510Z [container-agent]     raise ShellDBError(**exception)
2025-05-14T04:29:35.510Z [container-agent] mysql_shell.ShellDBError: MySQL Error (1290): ClassicSession.run_sql: The MySQL server is running with the --super-read-only option so it cannot execute this statement
2025-05-14T04:29:35.879Z [container-agent] 2025-05-14 04:29:35 ERROR juju.worker.uniter.operation runhook.go:180 hook "start" (via hook dispatching script: dispatch) failed: exit status 1
2025-05-14T04:29:35.881Z [container-agent] 2025-05-14 04:29:35 INFO juju.worker.uniter resolver.go:180 awaiting error resolution for "start" hook
2025-05-14T04:29:37.136Z [container-agent] 2025-05-14 04:29:37 INFO juju.worker.uniter resolver.go:180 awaiting error resolution for "start" hook
2025-05-14T04:29:44.332Z [pebble] Check "readiness" failure 30/3: non-2xx status code 418
2025-05-14T04:29:54.308Z [pebble] Check "readiness" failure 31/3: non-2xx status code 418
2025-05-14T04:30:04.318Z [pebble] Check "readiness" failure 32/3: non-2xx status code 418
2025-05-14T04:30:14.308Z [pebble] Check "readiness" failure 33/3: non-2xx status code 418
2025-05-14T04:30:24.319Z [pebble] Check "readiness" failure 34/3: non-2xx status code 418
2025-05-14T04:30:34.310Z [pebble] Check "readiness" failure 35/3: non-2xx status code 418
2025-05-14T04:30:44.319Z [pebble] Check "readiness" failure 36/3: non-2xx status code 418
2025-05-14T04:30:54.316Z [pebble] Check "readiness" failure 37/3: non-2xx status code 418
2025-05-14T04:31:04.314Z [pebble] Check "readiness" failure 38/3: non-2xx status code 418
2025-05-14T04:31:14.318Z [pebble] Check "readiness" failure 39/3: non-2xx status code 418
2025-05-14T04:31:24.322Z [pebble] Check "readiness" failure 40/3: non-2xx status code 418
2025-05-14T04:31:34.307Z [pebble] Check "readiness" failure 41/3: non-2xx status code 418
2025-05-14T04:31:44.306Z [pebble] Check "readiness" failure 42/3: non-2xx status code 418
2025-05-14T04:31:54.312Z [pebble] Check "readiness" failure 43/3: non-2xx status code 418
2025-05-14T04:32:04.324Z [pebble] Check "readiness" failure 44/3: non-2xx status code 418
2025-05-14T04:32:14.343Z [pebble] Check "readiness" failure 45/3: non-2xx status code 418
2025-05-14T04:32:21.680Z [container-agent] 2025-05-14 04:32:21 INFO juju.worker.uniter resolver.go:180 awaiting error resolution for "start" hook
2025-05-14T04:32:24.351Z [pebble] Check "readiness" failure 46/3: non-2xx status code 418
2025-05-14T04:32:26.349Z [container-agent] 2025-05-14 04:32:26 INFO juju-log Unable to connect to endpoint='nova-api-mysql-router-service.openstack.svc.cluster.local:6446'
2025-05-14T04:32:26.509Z [container-agent] 2025-05-14 04:32:26 INFO juju-log Enabling MySQL Router service
2025-05-14T04:32:34.313Z [pebble] Check "readiness" failure 47/3: non-2xx status code 418
2025-05-14T04:32:36.142Z [container-agent] 2025-05-14 04:32:36 INFO juju-log Enabled MySQL Router service
2025-05-14T04:32:39.410Z [container-agent] 2025-05-14 04:32:39 INFO juju-log Unable to connect to endpoint='nova-api-mysql-router-service.openstack.svc.cluster.local:6446'
2025-05-14T04:32:39.622Z [container-agent] 2025-05-14 04:32:39 INFO juju-log Unable to connect to endpoint='nova-api-mysql-router-service.openstack.svc.cluster.local:6446'
2025-05-14T04:32:42.139Z [container-agent] 2025-05-14 04:32:42 INFO juju.worker.uniter.operation runhook.go:186 ran "start" hook (via hook dispatching script: dispatch)
2025-05-14T04:32:47.154Z [container-agent] 2025-05-14 04:32:47 INFO juju-log Unable to connect to endpoint='nova-api-mysql-router-service.openstack.svc.cluster.local:6446'
2025-05-14T04:32:54.468Z [container-agent] 2025-05-14 04:32:54 INFO juju.worker.uniter.operation runhook.go:186 ran "mysql-router-pebble-ready" hook (via hook dispatching script: dispatch)
2025-05-14T04:35:25.612Z [container-agent] 2025-05-14 04:35:25 INFO juju.worker.uniter.operation runhook.go:186 ran "update-status" hook (via hook dispatching script: dispatch)
2025-05-14T04:41:25.816Z [container-agent] 2025-05-14 04:41:25 INFO juju.worker.uniter.operation runhook.go:186 ran "update-status" hook (via hook dispatching script: dispatch)
2025-05-14T04:45:53.899Z [container-agent] 2025-05-14 04:45:53 INFO juju.worker.uniter.operation runhook.go:186 ran "update-status" hook (via hook dispatching script: dispatch)
2025-05-14T04:50:58.513Z [container-agent] 2025-05-14 04:50:58 INFO juju.worker.uniter.operation runhook.go:186 ran "update-status" hook (via hook dispatching script: dispatch)
2025-05-14T04:55:39.251Z [container-agent] 2025-05-14 04:55:39 INFO juju.worker.uniter.operation runhook.go:186 ran "update-status" hook (via hook dispatching script: dispatch)
2025-05-14T05:01:11.652Z [container-agent] 2025-05-14 05:01:11 INFO juju.worker.uniter.operation runhook.go:186 ran "update-status" hook (via hook dispatching script: dispatch)
2025-05-14T05:06:02.321Z [container-agent] 2025-05-14 05:06:02 INFO juju.worker.uniter.operation runhook.go:186 ran "update-status" hook (via hook dispatching script: dispatch)
2025-05-14T05:11:45.760Z [container-agent] 2025-05-14 05:11:45 INFO juju.worker.uniter.operation runhook.go:186 ran "update-status" hook (via hook dispatching script: dispatch)
2025-05-14T05:17:05.984Z [container-agent] 2025-05-14 05:17:05 INFO juju.worker.uniter.operation runhook.go:186 ran "update-status" hook (via hook dispatching script: dispatch)
2025-05-14T05:21:33.754Z [container-agent] 2025-05-14 05:21:33 INFO juju.worker.uniter.operation runhook.go:186 ran "update-status" hook (via hook dispatching script: dispatch)
2025-05-14T05:26:45.343Z [container-agent] 2025-05-14 05:26:45 INFO juju.worker.uniter.operation runhook.go:186 ran "update-status" hook (via hook dispatching script: dispatch)
2025-05-14T07:07:14.981Z [container-agent] 2025-05-14 07:07:14 ERROR juju.api.watcher watcher.go:95 error trying to stop watcher: write tcp 10.1.0.250:36440->10.152.183.59:17070: write: connection reset by peer
2025-05-14T07:07:14.981Z [container-agent] 2025-05-14 07:07:14 ERROR juju.api.watcher watcher.go:95 error trying to stop watcher: write tcp 10.1.0.250:36440->10.152.183.59:17070: write: connection reset by peer
2025-05-14T07:07:14.981Z [container-agent] 2025-05-14 07:07:14 ERROR juju.api.watcher watcher.go:95 error trying to stop watcher: write tcp 10.1.0.250:36440->10.152.183.59:17070: write: connection reset by peer
2025-05-14T07:07:14.981Z [container-agent] 2025-05-14 07:07:14 ERROR juju.api.watcher watcher.go:95 error trying to stop watcher: write tcp 10.1.0.250:36440->10.152.183.59:17070: write: connection reset by peer
2025-05-14T07:07:14.981Z [container-agent] 2025-05-14 07:07:14 ERROR juju.api.watcher watcher.go:95 error trying to stop watcher: write tcp 10.1.0.250:36440->10.152.183.59:17070: write: connection reset by peer
2025-05-14T07:07:14.981Z [container-agent] 2025-05-14 07:07:14 ERROR juju.api.watcher watcher.go:95 error trying to stop watcher: write tcp 10.1.0.250:36440->10.152.183.59:17070: write: connection reset by peer
2025-05-14T07:07:14.981Z [container-agent] 2025-05-14 07:07:14 ERROR juju.api.watcher watcher.go:95 error trying to stop watcher: write tcp 10.1.0.250:36440->10.152.183.59:17070: write: connection reset by peer
2025-05-14T07:07:15.076Z [container-agent] 2025-05-14 07:07:15 INFO juju.worker.logger logger.go:136 logger worker stopped
2025-05-14T07:07:15.124Z [container-agent] 2025-05-14 07:07:14 ERROR juju.api.watcher watcher.go:95 error trying to stop watcher: write tcp 10.1.0.250:36440->10.152.183.59:17070: write: connection reset by peer
2025-05-14T07:07:15.124Z [container-agent] 2025-05-14 07:07:14 ERROR juju.api.watcher watcher.go:95 error trying to stop watcher: write tcp 10.1.0.250:36440->10.152.183.59:17070: write: connection reset by peer
2025-05-14T07:07:15.124Z [container-agent] 2025-05-14 07:07:14 ERROR juju.api.watcher watcher.go:95 error trying to stop watcher: write tcp 10.1.0.250:36440->10.152.183.59:17070: write: connection reset by peer
2025-05-14T07:07:15.166Z [container-agent] 2025-05-14 07:07:15 ERROR juju.worker.dependency engine.go:695 "migration-minion" manifold worker returned unexpected error: watcher has been stopped (stopped)
2025-05-14T07:07:15.304Z [container-agent] 2025-05-14 07:07:14 ERROR juju.api.watcher watcher.go:95 error trying to stop watcher: write tcp 10.1.0.250:36440->10.152.183.59:17070: write: connection reset by peer
2025-05-14T07:07:15.304Z [container-agent] 2025-05-14 07:07:14 ERROR juju.api.watcher watcher.go:95 error trying to stop watcher: write tcp 10.1.0.250:36440->10.152.183.59:17070: write: connection reset by peer
2025-05-14T07:07:15.304Z [container-agent] 2025-05-14 07:07:14 ERROR juju.api.watcher watcher.go:95 error trying to stop watcher: codec.ReadHeader error: error receiving message: write tcp 10.1.0.250:36440->10.152.183.59:17070: write: connection reset by peer
2025-05-14T07:07:15.304Z [container-agent] 2025-05-14 07:07:14 ERROR juju.api.watcher watcher.go:95 error trying to stop watcher: codec.ReadHeader error: error receiving message: write tcp 10.1.0.250:36440->10.152.183.59:17070: write: connection reset by peer
2025-05-14T07:07:15.304Z [container-agent] 2025-05-14 07:07:14 ERROR juju.api.watcher watcher.go:95 error trying to stop watcher: codec.ReadHeader error: error receiving message: write tcp 10.1.0.250:36440->10.152.183.59:17070: write: connection reset by peer
2025-05-14T07:07:15.304Z [container-agent] 2025-05-14 07:07:14 ERROR juju.api.watcher watcher.go:95 error trying to stop watcher: codec.ReadHeader error: error receiving message: write tcp 10.1.0.250:36440->10.152.183.59:17070: write: connection reset by peer
2025-05-14T07:07:15.304Z [container-agent] 2025-05-14 07:07:14 ERROR juju.api.watcher watcher.go:95 error trying to stop watcher: codec.ReadHeader error: error receiving message: write tcp 10.1.0.250:36440->10.152.183.59:17070: write: connection reset by peer
2025-05-14T07:07:15.304Z [container-agent] 2025-05-14 07:07:14 ERROR juju.api.watcher watcher.go:95 error trying to stop watcher: codec.ReadHeader error: error receiving message: write tcp 10.1.0.250:36440->10.152.183.59:17070: write: connection reset by peer
2025-05-14T07:07:15.304Z [container-agent] 2025-05-14 07:07:14 ERROR juju.api.watcher watcher.go:95 error trying to stop watcher: codec.ReadHeader error: error receiving message: write tcp 10.1.0.250:36440->10.152.183.59:17070: write: connection reset by peer
2025-05-14T07:07:15.304Z [container-agent] 2025-05-14 07:07:14 ERROR juju.api.watcher watcher.go:95 error trying to stop watcher: codec.ReadHeader error: error receiving message: write tcp 10.1.0.250:36440->10.152.183.59:17070: write: connection reset by peer
2025-05-14T07:07:15.304Z [container-agent] 2025-05-14 07:07:14 ERROR juju.api.watcher watcher.go:95 error trying to stop watcher: codec.ReadHeader error: error receiving message: write tcp 10.1.0.250:36440->10.152.183.59:17070: write: connection reset by peer
2025-05-14T07:07:15.304Z [container-agent] 2025-05-14 07:07:14 ERROR juju.api.watcher watcher.go:95 error trying to stop watcher: codec.ReadHeader error: error receiving message: write tcp 10.1.0.250:36440->10.152.183.59:17070: write: connection reset by peer
2025-05-14T07:07:15.304Z [container-agent] 2025-05-14 07:07:14 ERROR juju.api.watcher watcher.go:95 error trying to stop watcher: codec.ReadHeader error: error receiving message: write tcp 10.1.0.250:36440->10.152.183.59:17070: write: connection reset by peer
2025-05-14T07:07:15.304Z [container-agent] 2025-05-14 07:07:14 ERROR juju.api.watcher watcher.go:95 error trying to stop watcher: codec.ReadHeader error: error receiving message: write tcp 10.1.0.250:36440->10.152.183.59:17070: write: connection reset by peer
2025-05-14T07:07:15.304Z [container-agent] 2025-05-14 07:07:14 ERROR juju.api.watcher watcher.go:95 error trying to stop watcher: codec.ReadHeader error: error receiving message: write tcp 10.1.0.250:36440->10.152.183.59:17070: write: connection reset by peer
2025-05-14T07:07:15.304Z [container-agent] 2025-05-14 07:07:14 ERROR juju.api.watcher watcher.go:95 error trying to stop watcher: codec.ReadHeader error: error receiving message: write tcp 10.1.0.250:36440->10.152.183.59:17070: write: connection reset by peer
2025-05-14T07:07:15.304Z [container-agent] 2025-05-14 07:07:14 ERROR juju.api.watcher watcher.go:95 error trying to stop watcher: codec.ReadHeader error: error receiving message: write tcp 10.1.0.250:36440->10.152.183.59:17070: write: connection reset by peer
2025-05-14T07:07:15.304Z [container-agent] 2025-05-14 07:07:14 ERROR juju.api.watcher watcher.go:95 error trying to stop watcher: codec.ReadHeader error: error receiving message: write tcp 10.1.0.250:36440->10.152.183.59:17070: write: connection reset by peer
2025-05-14T07:07:15.304Z [container-agent] 2025-05-14 07:07:14 ERROR juju.api.watcher watcher.go:95 error trying to stop watcher: codec.ReadHeader error: error receiving message: write tcp 10.1.0.250:36440->10.152.183.59:17070: write: connection reset by peer
2025-05-14T07:07:15.304Z [container-agent] 2025-05-14 07:07:15 ERROR juju.worker.uniter agent.go:33 resolver loop error: preparing operation "run update-status hook" for nova-api-mysql-router/0: getting unit payloads: codec.ReadHeader error: error receiving message: write tcp 10.1.0.250:36440->10.152.183.59:17070: write: connection reset by peer
2025-05-14T07:07:15.304Z [container-agent] 2025-05-14 07:07:15 ERROR juju.worker.uniter agent.go:36 updating agent status: connection is shut down
2025-05-14T07:07:15.304Z [container-agent] 2025-05-14 07:07:15 INFO juju.worker.uniter uniter.go:349 unit "nova-api-mysql-router/0" shutting down: preparing operation "run update-status hook" for nova-api-mysql-router/0: getting unit payloads: codec.ReadHeader error: error receiving message: write tcp 10.1.0.250:36440->10.152.183.59:17070: write: connection reset by peer
2025-05-14T07:07:15.534Z [container-agent] 2025-05-14 07:07:15 ERROR juju.worker.dependency engine.go:695 "leadership-tracker" manifold worker returned unexpected error: leadership failure: error making a leadership claim: codec.ReadHeader error: error receiving message: write tcp 10.1.0.250:36440->10.152.183.59:17070: write: connection reset by peer
2025-05-14T07:07:15.589Z [container-agent] 2025-05-14 07:07:15 ERROR juju.worker.dependency engine.go:695 "upgrader" manifold worker returned unexpected error: watcher has been stopped (stopped)
2025-05-14T07:07:15.589Z [container-agent] 2025-05-14 07:07:15 ERROR juju.worker.dependency engine.go:695 "log-sender" manifold worker returned unexpected error: sending log message: write tcp 10.1.0.250:36452->10.152.183.59:17070: write: broken pipe: write tcp 10.1.0.250:36452->10.152.183.59:17070: write: broken pipe
2025-05-14T07:07:15.589Z [container-agent] 2025-05-14 07:07:15 ERROR juju.worker.dependency engine.go:695 "api-caller" manifold worker returned unexpected error: codec.ReadHeader error: error receiving message: write tcp 10.1.0.250:36440->10.152.183.59:17070: write: connection reset by peer
2025-05-14T07:07:20.715Z [container-agent] 2025-05-14 07:07:20 INFO juju.api apiclient.go:979 cannot resolve "controller-service.controller-sunbeam-controller.svc.cluster.local": lookup controller-service.controller-sunbeam-controller.svc.cluster.local: operation was canceled
2025-05-14T07:07:20.715Z [container-agent] 2025-05-14 07:07:20 INFO juju.api apiclient.go:601 connection established to "wss://10.152.183.59:17070/model/ee070cdf-4b8b-49ac-80cb-918841540fbe/api"
2025-05-14T07:07:21.288Z [container-agent] 2025-05-14 07:07:21 INFO juju.worker.apicaller connect.go:163 [ee070c] "unit-nova-api-mysql-router-0" successfully connected to "wss://10.152.183.59:17070"
2025-05-14T07:07:21.859Z [container-agent] 2025-05-14 07:07:21 INFO juju.worker.logger logger.go:120 logger worker started
2025-05-14T07:07:21.859Z [container-agent] 2025-05-14 07:07:21 INFO juju.worker.migrationminion worker.go:208 migration phase is now: NONE
2025-05-14T07:07:22.556Z [container-agent] 2025-05-14 07:07:22 WARNING juju.worker.proxyupdater proxyupdater.go:237 unable to set snap core settings [proxy.http= proxy.https= proxy.store=]: exec: "snap": executable file not found in $PATH, output: ""
2025-05-14T07:07:24.729Z [container-agent] 2025-05-14 07:07:24 INFO juju.worker.caasupgrader upgrader.go:113 abort check blocked until version event received
2025-05-14T07:07:24.730Z [container-agent] 2025-05-14 07:07:24 INFO juju.worker.caasupgrader upgrader.go:119 unblocking abort check
2025-05-14T07:07:24.946Z [pebble] Check "readiness" failure 1/3: non-2xx status code 418
2025-05-14T07:07:25.349Z [container-agent] 2025-05-14 07:07:25 INFO juju.worker.leadership tracker.go:244 nova-api-mysql-router/0 promoted to leadership of nova-api-mysql-router
2025-05-14T07:07:25.509Z [container-agent] 2025-05-14 07:07:25 INFO juju.agent.tools symlinks.go:20 ensure jujuc symlinks in /var/lib/juju/tools/unit-nova-api-mysql-router-0
2025-05-14T07:07:31.078Z [container-agent] 2025-05-14 07:07:31 INFO juju.worker.uniter uniter.go:365 unit "nova-api-mysql-router/0" started
2025-05-14T07:07:31.668Z [container-agent] 2025-05-14 07:07:31 INFO juju.worker.uniter uniter.go:391 hooks are retried true
2025-05-14T07:07:34.569Z [pebble] Check "readiness" failure 2/3: non-2xx status code 418
2025-05-14T07:07:35.226Z [container-agent] 2025-05-14 07:07:35 INFO juju.worker.uniter resolver.go:76 reboot detected; triggering implicit start hook to notify charm
2025-05-14T07:07:44.486Z [pebble] Check "readiness" failure 3/3: non-2xx status code 418
2025-05-14T07:07:44.486Z [pebble] Check "readiness" threshold 3 hit, triggering action and recovering
2025-05-14T07:07:44.486Z [pebble] Change 63 task (Perform HTTP check "readiness") failed: non-2xx status code 418
2025-05-14T07:07:54.787Z [pebble] Check "readiness" failure 4/3: non-2xx status code 418
2025-05-14T07:08:03.449Z [container-agent] 2025-05-14 07:08:03 INFO juju-log Unable to connect to endpoint='nova-api-mysql-router-service.openstack.svc.cluster.local:6446'
2025-05-14T07:08:04.638Z [pebble] Check "readiness" failure 5/3: non-2xx status code 418
2025-05-14T07:08:14.771Z [pebble] Check "readiness" failure 6/3: non-2xx status code 418
2025-05-14T07:08:23.931Z [container-agent] 2025-05-14 07:08:23 INFO juju-log Unable to connect to endpoint='nova-api-mysql-router-service.openstack.svc.cluster.local:6446'
2025-05-14T07:08:24.695Z [pebble] Check "readiness" failure 7/3: non-2xx status code 418
2025-05-14T07:08:25.050Z [container-agent] 2025-05-14 07:08:25 INFO juju-log Unable to connect to endpoint='nova-api-mysql-router-service.openstack.svc.cluster.local:6446'
2025-05-14T07:08:34.828Z [pebble] Check "readiness" failure 8/3: non-2xx status code 418
2025-05-14T07:08:37.832Z [container-agent] 2025-05-14 07:08:37 INFO juju.worker.uniter.operation runhook.go:186 ran "start" hook (via hook dispatching script: dispatch)
2025-05-14T07:09:16.694Z [container-agent] 2025-05-14 07:09:16 INFO juju.worker.uniter.operation runhook.go:186 ran "mysql-router-pebble-ready" hook (via hook dispatching script: dispatch)
2025-05-14T07:12:17.321Z [container-agent] 2025-05-14 07:12:17 INFO juju.worker.uniter.operation runhook.go:186 ran "update-status" hook (via hook dispatching script: dispatch)
2025-05-14T07:17:25.882Z [container-agent] 2025-05-14 07:17:25 INFO juju.worker.uniter.operation runhook.go:186 ran "update-status" hook (via hook dispatching script: dispatch)
2025-05-14T07:22:38.285Z [container-agent] 2025-05-14 07:22:38 INFO juju.worker.uniter.operation runhook.go:186 ran "update-status" hook (via hook dispatching script: dispatch)
2025-05-14T07:27:19.706Z [container-agent] 2025-05-14 07:27:19 INFO juju.worker.uniter.operation runhook.go:186 ran "update-status" hook (via hook dispatching script: dispatch)
2025-05-14T07:31:24.217Z [container-agent] 2025-05-14 07:31:24 INFO juju.worker.uniter.operation runhook.go:186 ran "update-status" hook (via hook dispatching script: dispatch)
2025-05-14T07:37:22.148Z [container-agent] 2025-05-14 07:37:22 INFO juju.worker.uniter.operation runhook.go:186 ran "update-status" hook (via hook dispatching script: dispatch)
2025-05-14T07:42:04.012Z [container-agent] 2025-05-14 07:42:04 INFO juju.worker.uniter.operation runhook.go:186 ran "update-status" hook (via hook dispatching script: dispatch)
2025-05-14T07:47:21.587Z [container-agent] 2025-05-14 07:47:21 INFO juju.worker.uniter.operation runhook.go:186 ran "update-status" hook (via hook dispatching script: dispatch)
2025-05-14T07:52:37.057Z [container-agent] 2025-05-14 07:52:37 INFO juju.worker.uniter.operation runhook.go:186 ran "update-status" hook (via hook dispatching script: dispatch)
2025-05-14T07:57:41.493Z [container-agent] 2025-05-14 07:57:41 INFO juju.worker.uniter.operation runhook.go:186 ran "update-status" hook (via hook dispatching script: dispatch)
2025-05-14T08:02:14.966Z [container-agent] 2025-05-14 08:02:14 INFO juju.worker.uniter.operation runhook.go:186 ran "update-status" hook (via hook dispatching script: dispatch)
2025-05-14T08:06:56.697Z [container-agent] 2025-05-14 08:06:56 INFO juju.worker.uniter.operation runhook.go:186 ran "update-status" hook (via hook dispatching script: dispatch)
2025-05-14T08:11:49.176Z [container-agent] 2025-05-14 08:11:49 INFO juju.worker.uniter.operation runhook.go:186 ran "update-status" hook (via hook dispatching script: dispatch)
2025-05-14T08:16:45.255Z [container-agent] 2025-05-14 08:16:45 INFO juju.worker.uniter.operation runhook.go:186 ran "update-status" hook (via hook dispatching script: dispatch)
2025-05-14T08:21:05.678Z [container-agent] 2025-05-14 08:21:05 INFO juju.worker.uniter.operation runhook.go:186 ran "update-status" hook (via hook dispatching script: dispatch)
2025-05-14T08:25:15.610Z [container-agent] 2025-05-14 08:25:15 INFO juju.worker.uniter.operation runhook.go:186 ran "update-status" hook (via hook dispatching script: dispatch)
2025-05-14T08:30:44.507Z [container-agent] 2025-05-14 08:30:44 INFO juju.worker.uniter.operation runhook.go:186 ran "update-status" hook (via hook dispatching script: dispatch)
2025-05-14T08:35:35.377Z [container-agent] 2025-05-14 08:35:35 INFO juju.worker.uniter.operation runhook.go:186 ran "update-status" hook (via hook dispatching script: dispatch)
2025-05-14T08:41:09.549Z [container-agent] 2025-05-14 08:41:09 INFO juju.worker.uniter.operation runhook.go:186 ran "update-status" hook (via hook dispatching script: dispatch)
2025-05-14T08:45:27.851Z [container-agent] 2025-05-14 08:45:27 INFO juju.worker.uniter.operation runhook.go:186 ran "update-status" hook (via hook dispatching script: dispatch)
2025-05-14T08:49:55.923Z [container-agent] 2025-05-14 08:49:55 INFO juju.worker.uniter.operation runhook.go:186 ran "update-status" hook (via hook dispatching script: dispatch)
2025-05-14T08:55:38.979Z [container-agent] 2025-05-14 08:55:38 INFO juju.worker.uniter.operation runhook.go:186 ran "update-status" hook (via hook dispatching script: dispatch)
2025-05-14T09:00:49.073Z [container-agent] 2025-05-14 09:00:49 INFO juju.worker.uniter.operation runhook.go:186 ran "update-status" hook (via hook dispatching script: dispatch)
2025-05-14T09:04:58.631Z [container-agent] 2025-05-14 09:04:58 INFO juju.worker.uniter.operation runhook.go:186 ran "update-status" hook (via hook dispatching script: dispatch)
2025-05-14T09:09:58.144Z [container-agent] 2025-05-14 09:09:58 INFO juju.worker.uniter.operation runhook.go:186 ran "update-status" hook (via hook dispatching script: dispatch)
2025-05-14T09:14:16.377Z [container-agent] 2025-05-14 09:14:16 INFO juju.worker.uniter.operation runhook.go:186 ran "update-status" hook (via hook dispatching script: dispatch)
2025-05-14T09:19:16.604Z [container-agent] 2025-05-14 09:19:16 INFO juju.worker.uniter.operation runhook.go:186 ran "update-status" hook (via hook dispatching script: dispatch)
2025-05-14T09:24:24.574Z [container-agent] 2025-05-14 09:24:24 INFO juju.worker.uniter.operation runhook.go:186 ran "update-status" hook (via hook dispatching script: dispatch)
2025-05-14T09:29:25.150Z [container-agent] 2025-05-14 09:29:25 INFO juju.worker.uniter.operation runhook.go:186 ran "update-status" hook (via hook dispatching script: dispatch)
2025-05-14T09:29:25.151Z [container-agent] 2025-05-14 09:29:25 ERROR juju.worker.dependency engine.go:695 "log-sender" manifold worker returned unexpected error: sending log message: websocket: close 1005 (no status): websocket: close sent
2025-05-14T09:34:17.497Z [container-agent] 2025-05-14 09:34:17 INFO juju.worker.uniter.operation runhook.go:186 ran "update-status" hook (via hook dispatching script: dispatch)
2025-05-14T09:39:24.862Z [container-agent] 2025-05-14 09:39:24 INFO juju.worker.uniter.operation runhook.go:186 ran "update-status" hook (via hook dispatching script: dispatch)
2025-05-14T09:43:31.590Z [container-agent] 2025-05-14 09:43:31 INFO juju.worker.uniter.operation runhook.go:186 ran "update-status" hook (via hook dispatching script: dispatch)
2025-05-14T09:48:31.342Z [container-agent] 2025-05-14 09:48:31 INFO juju.worker.uniter.operation runhook.go:186 ran "update-status" hook (via hook dispatching script: dispatch)
2025-05-14T09:53:48.470Z [container-agent] 2025-05-14 09:53:48 INFO juju.worker.uniter.operation runhook.go:186 ran "update-status" hook (via hook dispatching script: dispatch)
2025-05-14T09:59:04.683Z [container-agent] 2025-05-14 09:59:04 INFO juju.worker.uniter.operation runhook.go:186 ran "update-status" hook (via hook dispatching script: dispatch)
2025-05-14T10:04:13.527Z [container-agent] 2025-05-14 10:04:13 INFO juju.worker.uniter.operation runhook.go:186 ran "update-status" hook (via hook dispatching script: dispatch)
2025-05-14T10:08:48.346Z [container-agent] 2025-05-14 10:08:48 INFO juju.worker.uniter.operation runhook.go:186 ran "update-status" hook (via hook dispatching script: dispatch)
2025-05-14T10:14:15.576Z [container-agent] 2025-05-14 10:14:15 INFO juju.worker.uniter.operation runhook.go:186 ran "update-status" hook (via hook dispatching script: dispatch)
2025-05-14T10:18:16.660Z [container-agent] 2025-05-14 10:18:16 INFO juju.worker.uniter.operation runhook.go:186 ran "update-status" hook (via hook dispatching script: dispatch)
2025-05-14T10:24:05.495Z [container-agent] 2025-05-14 10:24:05 INFO juju.worker.uniter.operation runhook.go:186 ran "update-status" hook (via hook dispatching script: dispatch)
2025-05-14T10:28:06.314Z [container-agent] 2025-05-14 10:28:06 INFO juju.worker.uniter.operation runhook.go:186 ran "update-status" hook (via hook dispatching script: dispatch)
2025-05-14T11:22:25.391Z [container-agent] 2025-05-14 11:22:25 ERROR juju.worker.dependency engine.go:695 "migration-minion" manifold worker returned unexpected error: watcher has been stopped (stopped)
2025-05-14T11:22:25.391Z [container-agent] 2025-05-14 11:22:25 ERROR juju.worker.dependency engine.go:695 "log-sender" manifold worker returned unexpected error: sending log message: write tcp 10.1.0.250:41018->10.152.183.59:17070: write: broken pipe: write tcp 10.1.0.250:41018->10.152.183.59:17070: write: broken pipe
2025-05-14T11:22:25.578Z [container-agent] 2025-05-14 11:22:25 ERROR juju.worker.dependency engine.go:695 "api-caller" manifold worker returned unexpected error: api connection broken unexpectedly
2025-05-14T11:22:25.582Z [container-agent] 2025-05-14 11:22:25 INFO juju.worker.logger logger.go:136 logger worker stopped
2025-05-14T11:22:25.717Z [container-agent] 2025-05-14 11:22:25 ERROR juju.worker.uniter agent.go:33 resolver loop error: preparing operation "run update-status hook" for nova-api-mysql-router/0: getting unit payloads: connection is shut down
2025-05-14T11:22:25.717Z [container-agent] 2025-05-14 11:22:25 ERROR juju.worker.uniter agent.go:36 updating agent status: connection is shut down
2025-05-14T11:22:25.717Z [container-agent] 2025-05-14 11:22:25 INFO juju.worker.uniter uniter.go:349 unit "nova-api-mysql-router/0" shutting down: preparing operation "run update-status hook" for nova-api-mysql-router/0: getting unit payloads: connection is shut down
2025-05-14T11:22:29.211Z [container-agent] 2025-05-14 11:22:29 INFO juju.api apiclient.go:601 connection established to "wss://10.152.183.59:17070/model/ee070cdf-4b8b-49ac-80cb-918841540fbe/api"
2025-05-14T11:22:30.092Z [container-agent] 2025-05-14 11:22:30 INFO juju.worker.apicaller connect.go:163 [ee070c] "unit-nova-api-mysql-router-0" successfully connected to "wss://10.152.183.59:17070"
2025-05-14T11:22:30.733Z [container-agent] 2025-05-14 11:22:30 INFO juju.worker.logger logger.go:120 logger worker started
2025-05-14T11:22:31.037Z [container-agent] 2025-05-14 11:22:31 INFO juju.worker.migrationminion worker.go:208 migration phase is now: NONE
2025-05-14T11:22:33.020Z [container-agent] 2025-05-14 11:22:33 WARNING juju.worker.proxyupdater proxyupdater.go:237 unable to set snap core settings [proxy.http= proxy.https= proxy.store=]: exec: "snap": executable file not found in $PATH, output: ""
2025-05-14T11:22:33.707Z [container-agent] 2025-05-14 11:22:33 INFO juju.worker.leadership tracker.go:244 nova-api-mysql-router/0 promoted to leadership of nova-api-mysql-router
2025-05-14T11:22:35.519Z [container-agent] 2025-05-14 11:22:35 INFO juju.agent.tools symlinks.go:20 ensure jujuc symlinks in /var/lib/juju/tools/unit-nova-api-mysql-router-0
2025-05-14T11:22:35.752Z [pebble] Check "readiness" failure 1/3: non-2xx status code 418
2025-05-14T11:22:36.064Z [container-agent] 2025-05-14 11:22:36 INFO juju.worker.caasupgrader upgrader.go:113 abort check blocked until version event received
2025-05-14T11:22:36.064Z [container-agent] 2025-05-14 11:22:36 INFO juju.worker.caasupgrader upgrader.go:119 unblocking abort check
2025-05-14T11:22:41.967Z [container-agent] 2025-05-14 11:22:41 INFO juju.worker.uniter uniter.go:365 unit "nova-api-mysql-router/0" started
2025-05-14T11:22:42.551Z [container-agent] 2025-05-14 11:22:42 INFO juju.worker.uniter uniter.go:391 hooks are retried true
2025-05-14T11:22:44.776Z [pebble] Check "readiness" failure 2/3: non-2xx status code 418
2025-05-14T11:22:45.038Z [container-agent] 2025-05-14 11:22:45 INFO juju.worker.uniter resolver.go:76 reboot detected; triggering implicit start hook to notify charm
2025-05-14T11:22:54.748Z [pebble] Check "readiness" failure 3/3: non-2xx status code 418
2025-05-14T11:22:54.748Z [pebble] Check "readiness" threshold 3 hit, triggering action and recovering
2025-05-14T11:22:54.748Z [pebble] Change 65 task (Perform HTTP check "readiness") failed: non-2xx status code 418
2025-05-14T11:23:05.144Z [pebble] Check "readiness" failure 4/3: non-2xx status code 418
2025-05-14T11:23:15.139Z [pebble] Check "readiness" failure 5/3: non-2xx status code 418
2025-05-14T11:23:25.141Z [pebble] Check "readiness" failure 6/3: non-2xx status code 418
2025-05-14T11:23:26.027Z [container-agent] 2025-05-14 11:23:26 INFO juju-log Unable to connect to endpoint='nova-api-mysql-router-service.openstack.svc.cluster.local:6446'
2025-05-14T11:23:27.039Z [container-agent] 2025-05-14 11:23:27 INFO juju-log Unable to connect to endpoint='nova-api-mysql-router-service.openstack.svc.cluster.local:6446'
2025-05-14T11:23:30.037Z [container-agent] 2025-05-14 11:23:30 ERROR juju-log Failed to run MySQL Shell script:
2025-05-14T11:23:30.037Z [container-agent] import json
2025-05-14T11:23:30.037Z [container-agent] import mysqlsh
2025-05-14T11:23:30.037Z [container-agent] import traceback
2025-05-14T11:23:30.037Z [container-agent] 
2025-05-14T11:23:30.037Z [container-agent] try:
2025-05-14T11:23:30.037Z [container-agent]     # Disable wizards in this script, since it will be invoked without --no-wizard
2025-05-14T11:23:30.037Z [container-agent]     shell.options.set('useWizards', False)
2025-05-14T11:23:30.037Z [container-agent]     import json
2025-05-14T11:23:30.037Z [container-agent] 
2025-05-14T11:23:30.037Z [container-agent]     cluster_set = dba.get_cluster_set()
2025-05-14T11:23:30.037Z [container-agent]     routers = cluster_set.list_routers()
2025-05-14T11:23:30.037Z [container-agent]     # mysqlsh objects are weirdâ€”they quack (i.e. duck typing) like standard Python objects (e.g. list,
2025-05-14T11:23:30.037Z [container-agent]     # dict), but do not serialize to JSON correctly.
2025-05-14T11:23:30.037Z [container-agent]     # Cast to str & load from JSON str before serializing
2025-05-14T11:23:30.037Z [container-agent]     routers = json.loads(str(routers))
2025-05-14T11:23:30.037Z [container-agent]     with open("/tmp/mysqlsh_output.json", "w") as file:
2025-05-14T11:23:30.037Z [container-agent]         json.dump(routers, file)
2025-05-14T11:23:30.037Z [container-agent] except mysqlsh.DBError as exception:
2025-05-14T11:23:30.037Z [container-agent]     error = {
2025-05-14T11:23:30.037Z [container-agent]         "message": str(exception),
2025-05-14T11:23:30.037Z [container-agent]         "code": exception.code,
2025-05-14T11:23:30.037Z [container-agent]         "traceback_message": "".join(traceback.format_exception(exception)),
2025-05-14T11:23:30.037Z [container-agent]     }
2025-05-14T11:23:30.037Z [container-agent] else:
2025-05-14T11:23:30.037Z [container-agent]     error = None
2025-05-14T11:23:30.037Z [container-agent] with open("/tmp/mysqlsh_error.json", "w") as file:
2025-05-14T11:23:30.037Z [container-agent]     json.dump(error, file)
2025-05-14T11:23:30.037Z [container-agent] 
2025-05-14T11:23:30.037Z [container-agent] stderr:
2025-05-14T11:23:30.037Z [container-agent] Cannot set LC_ALL to locale en_US.UTF-8: No such file or directory
2025-05-14T11:23:30.037Z [container-agent] MySQL Error 2003 (HY000): Can't connect to MySQL server on 'mysql-primary.openstack.svc.cluster.local:3306' (1)
2025-05-14T11:23:30.037Z [container-agent] 
2025-05-14T11:23:30.037Z [container-agent] Traceback (most recent call last):
2025-05-14T11:23:30.037Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/src/rock.py", line 245, in _run_command
2025-05-14T11:23:30.037Z [container-agent]     output, _ = process.wait_output()
2025-05-14T11:23:30.037Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/venv/lib/python3.10/site-packages/ops/pebble.py", line 1441, in wait_output
2025-05-14T11:23:30.037Z [container-agent]     raise ExecError[AnyStr](self._command, exit_code, out_value, err_value)
2025-05-14T11:23:30.037Z [container-agent] ops.pebble.ExecError: non-zero exit code 1 executing ['mysqlsh', '--passwords-from-stdin', '--uri', 'relation-105_ee070cdf4b8b4@mysql-primary.openstack.svc.cluster.local:3306', '--python', '--file', '/tmp/mysqlsh_script.py'], stdout="\x1b[1mPlease provide the password for 'relation-105_ee070cdf4b8b4@mysql-primary.openstack.svc.cluster.local:3306': \x1b[0m", stderr="Cannot set LC_ALL to locale en_US.UTF-8: No such file or directory\nMySQL Error 2003 (HY000): Can't connect to MySQL server on 'mysql-primary.openstack.svc.cluster.local:3306' (1)\n"
2025-05-14T11:23:30.037Z [container-agent] 
2025-05-14T11:23:30.037Z [container-agent] During handling of the above exception, another exception occurred:
2025-05-14T11:23:30.037Z [container-agent] 
2025-05-14T11:23:30.037Z [container-agent] Traceback (most recent call last):
2025-05-14T11:23:30.037Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/src/mysql_shell/__init__.py", line 74, in _run_code
2025-05-14T11:23:30.037Z [container-agent]     self._container.run_mysql_shell(
2025-05-14T11:23:30.037Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/lib/charms/tempo_coordinator_k8s/v0/charm_tracing.py", line 735, in wrapped_function
2025-05-14T11:23:30.037Z [container-agent]     return callable(*args, **kwargs)  # type: ignore
2025-05-14T11:23:30.037Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/src/container.py", line 212, in run_mysql_shell
2025-05-14T11:23:30.037Z [container-agent]     return self._run_command(args, timeout=timeout, input=input)
2025-05-14T11:23:30.037Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/lib/charms/tempo_coordinator_k8s/v0/charm_tracing.py", line 735, in wrapped_function
2025-05-14T11:23:30.037Z [container-agent]     return callable(*args, **kwargs)  # type: ignore
2025-05-14T11:23:30.037Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/src/rock.py", line 247, in _run_command
2025-05-14T11:23:30.037Z [container-agent]     raise container.CalledProcessError(
2025-05-14T11:23:30.037Z [container-agent] container.CalledProcessError: Command '['mysqlsh', '--passwords-from-stdin', '--uri', 'relation-105_ee070cdf4b8b4@mysql-primary.openstack.svc.cluster.local:3306', '--python', '--file', '/tmp/mysqlsh_script.py']' returned non-zero exit status 1.
2025-05-14T11:23:30.432Z [container-agent] 2025-05-14 11:23:30 ERROR juju-log Uncaught exception while in charm code:
2025-05-14T11:23:30.432Z [container-agent] Traceback (most recent call last):
2025-05-14T11:23:30.432Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/src/rock.py", line 245, in _run_command
2025-05-14T11:23:30.432Z [container-agent]     output, _ = process.wait_output()
2025-05-14T11:23:30.432Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/venv/lib/python3.10/site-packages/ops/pebble.py", line 1441, in wait_output
2025-05-14T11:23:30.432Z [container-agent]     raise ExecError[AnyStr](self._command, exit_code, out_value, err_value)
2025-05-14T11:23:30.432Z [container-agent] ops.pebble.ExecError: non-zero exit code 1 executing ['mysqlsh', '--passwords-from-stdin', '--uri', 'relation-105_ee070cdf4b8b4@mysql-primary.openstack.svc.cluster.local:3306', '--python', '--file', '/tmp/mysqlsh_script.py'], stdout="\x1b[1mPlease provide the password for 'relation-105_ee070cdf4b8b4@mysql-primary.openstack.svc.cluster.local:3306': \x1b[0m", stderr="Cannot set LC_ALL to locale en_US.UTF-8: No such file or directory\nMySQL Error 2003 (HY000): Can't connect to MySQL server on 'mysql-primary.openstack.svc.cluster.local:3306' (1)\n"
2025-05-14T11:23:30.432Z [container-agent] 
2025-05-14T11:23:30.432Z [container-agent] During handling of the above exception, another exception occurred:
2025-05-14T11:23:30.432Z [container-agent] 
2025-05-14T11:23:30.432Z [container-agent] Traceback (most recent call last):
2025-05-14T11:23:30.432Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/src/charm.py", line 448, in <module>
2025-05-14T11:23:30.432Z [container-agent]     ops.main.main(KubernetesRouterCharm)
2025-05-14T11:23:30.432Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/venv/lib/python3.10/site-packages/ops/main.py", line 436, in main
2025-05-14T11:23:30.432Z [container-agent]     _emit_charm_event(charm, dispatcher.event_name)
2025-05-14T11:23:30.432Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/venv/lib/python3.10/site-packages/ops/main.py", line 144, in _emit_charm_event
2025-05-14T11:23:30.432Z [container-agent]     event_to_emit.emit(*args, **kwargs)
2025-05-14T11:23:30.432Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/venv/lib/python3.10/site-packages/ops/framework.py", line 351, in emit
2025-05-14T11:23:30.432Z [container-agent]     framework._emit(event)
2025-05-14T11:23:30.432Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/venv/lib/python3.10/site-packages/ops/framework.py", line 853, in _emit
2025-05-14T11:23:30.432Z [container-agent]     self._reemit(event_path)
2025-05-14T11:23:30.432Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/venv/lib/python3.10/site-packages/ops/framework.py", line 942, in _reemit
2025-05-14T11:23:30.432Z [container-agent]     custom_handler(event)
2025-05-14T11:23:30.432Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/lib/charms/tempo_coordinator_k8s/v0/charm_tracing.py", line 735, in wrapped_function
2025-05-14T11:23:30.432Z [container-agent]     return callable(*args, **kwargs)  # type: ignore
2025-05-14T11:23:30.432Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/src/abstract_charm.py", line 375, in reconcile
2025-05-14T11:23:30.432Z [container-agent]     self.set_status(event=event)
2025-05-14T11:23:30.432Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/lib/charms/tempo_coordinator_k8s/v0/charm_tracing.py", line 735, in wrapped_function
2025-05-14T11:23:30.432Z [container-agent]     return callable(*args, **kwargs)  # type: ignore
2025-05-14T11:23:30.432Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/src/abstract_charm.py", line 232, in set_status
2025-05-14T11:23:30.432Z [container-agent]     self.unit.status = self._determine_unit_status(event=event)
2025-05-14T11:23:30.432Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/lib/charms/tempo_coordinator_k8s/v0/charm_tracing.py", line 735, in wrapped_function
2025-05-14T11:23:30.432Z [container-agent]     return callable(*args, **kwargs)  # type: ignore
2025-05-14T11:23:30.432Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/src/abstract_charm.py", line 217, in _determine_unit_status
2025-05-14T11:23:30.432Z [container-agent]     workload_status = self.get_workload(event=event).status
2025-05-14T11:23:30.432Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/src/workload.py", line 414, in status
2025-05-14T11:23:30.432Z [container-agent]     if not self.shell.is_router_in_cluster_set(self._router_id):
2025-05-14T11:23:30.432Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/src/mysql_shell/__init__.py", line 214, in is_router_in_cluster_set
2025-05-14T11:23:30.432Z [container-agent]     self._run_code(
2025-05-14T11:23:30.432Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/src/mysql_shell/__init__.py", line 74, in _run_code
2025-05-14T11:23:30.432Z [container-agent]     self._container.run_mysql_shell(
2025-05-14T11:23:30.432Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/lib/charms/tempo_coordinator_k8s/v0/charm_tracing.py", line 735, in wrapped_function
2025-05-14T11:23:30.432Z [container-agent]     return callable(*args, **kwargs)  # type: ignore
2025-05-14T11:23:30.432Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/src/container.py", line 212, in run_mysql_shell
2025-05-14T11:23:30.432Z [container-agent]     return self._run_command(args, timeout=timeout, input=input)
2025-05-14T11:23:30.432Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/lib/charms/tempo_coordinator_k8s/v0/charm_tracing.py", line 735, in wrapped_function
2025-05-14T11:23:30.432Z [container-agent]     return callable(*args, **kwargs)  # type: ignore
2025-05-14T11:23:30.432Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/src/rock.py", line 247, in _run_command
2025-05-14T11:23:30.432Z [container-agent]     raise container.CalledProcessError(
2025-05-14T11:23:30.432Z [container-agent] container.CalledProcessError: Command '['mysqlsh', '--passwords-from-stdin', '--uri', 'relation-105_ee070cdf4b8b4@mysql-primary.openstack.svc.cluster.local:3306', '--python', '--file', '/tmp/mysqlsh_script.py']' returned non-zero exit status 1.
2025-05-14T11:23:32.488Z [container-agent] 2025-05-14 11:23:32 ERROR juju.worker.uniter.operation runhook.go:180 hook "start" (via hook dispatching script: dispatch) failed: exit status 1
2025-05-14T11:23:32.520Z [container-agent] 2025-05-14 11:23:32 INFO juju.worker.uniter resolver.go:180 awaiting error resolution for "start" hook
2025-05-14T11:23:35.117Z [pebble] Check "readiness" failure 7/3: non-2xx status code 418
2025-05-14T11:23:37.571Z [container-agent] 2025-05-14 11:23:37 INFO juju.worker.uniter resolver.go:180 awaiting error resolution for "start" hook
2025-05-14T11:23:45.154Z [pebble] Check "readiness" failure 8/3: non-2xx status code 418
2025-05-14T11:23:52.215Z [container-agent] 2025-05-14 11:23:52 INFO juju-log Unable to connect to endpoint='nova-api-mysql-router-service.openstack.svc.cluster.local:6446'
2025-05-14T11:23:55.117Z [pebble] Check "readiness" failure 9/3: non-2xx status code 418
2025-05-14T11:24:03.619Z [container-agent] 2025-05-14 11:24:03 INFO juju-log Unable to connect to endpoint='nova-api-mysql-router-service.openstack.svc.cluster.local:6446'
2025-05-14T11:24:04.282Z [container-agent] 2025-05-14 11:24:04 INFO juju-log Unable to connect to endpoint='nova-api-mysql-router-service.openstack.svc.cluster.local:6446'
2025-05-14T11:24:05.234Z [pebble] Check "readiness" failure 10/3: non-2xx status code 418
2025-05-14T11:24:12.829Z [container-agent] 2025-05-14 11:24:12 INFO juju.worker.uniter.operation runhook.go:186 ran "start" hook (via hook dispatching script: dispatch)
2025-05-14T11:24:51.455Z [container-agent] 2025-05-14 11:24:51 INFO juju.worker.uniter.operation runhook.go:186 ran "mysql-router-pebble-ready" hook (via hook dispatching script: dispatch)
2025-05-14T11:27:34.506Z [container-agent] 2025-05-14 11:27:34 INFO juju.worker.uniter.operation runhook.go:186 ran "update-status" hook (via hook dispatching script: dispatch)
2025-05-14T11:33:25.942Z [container-agent] 2025-05-14 11:33:25 INFO juju.worker.uniter.operation runhook.go:186 ran "update-status" hook (via hook dispatching script: dispatch)
2025-05-14T11:37:33.588Z [container-agent] 2025-05-14 11:37:33 INFO juju.worker.uniter.operation runhook.go:186 ran "update-status" hook (via hook dispatching script: dispatch)
2025-05-14T11:42:45.042Z [container-agent] 2025-05-14 11:42:45 INFO juju.worker.uniter.operation runhook.go:186 ran "update-status" hook (via hook dispatching script: dispatch)
2025-05-14T11:47:02.263Z [container-agent] 2025-05-14 11:47:02 INFO juju.worker.uniter.operation runhook.go:186 ran "update-status" hook (via hook dispatching script: dispatch)
2025-05-14T11:51:47.901Z [container-agent] 2025-05-14 11:51:47 INFO juju.worker.uniter.operation runhook.go:186 ran "update-status" hook (via hook dispatching script: dispatch)
2025-05-14T11:57:39.826Z [container-agent] 2025-05-14 11:57:39 INFO juju.worker.uniter.operation runhook.go:186 ran "update-status" hook (via hook dispatching script: dispatch)
2025-05-14T12:02:17.577Z [container-agent] 2025-05-14 12:02:17 INFO juju.worker.uniter.operation runhook.go:186 ran "update-status" hook (via hook dispatching script: dispatch)
2025-05-14T12:06:55.529Z [container-agent] 2025-05-14 12:06:55 INFO juju.worker.uniter.operation runhook.go:186 ran "update-status" hook (via hook dispatching script: dispatch)
2025-05-14T12:11:17.044Z [container-agent] 2025-05-14 12:11:17 INFO juju.worker.uniter.operation runhook.go:186 ran "update-status" hook (via hook dispatching script: dispatch)
2025-05-14T12:17:01.024Z [container-agent] 2025-05-14 12:17:01 INFO juju.worker.uniter.operation runhook.go:186 ran "update-status" hook (via hook dispatching script: dispatch)
2025-05-14T12:22:28.784Z [container-agent] 2025-05-14 12:22:28 INFO juju.worker.uniter.operation runhook.go:186 ran "update-status" hook (via hook dispatching script: dispatch)
2025-05-14T12:28:08.442Z [container-agent] 2025-05-14 12:28:08 INFO juju.worker.uniter.operation runhook.go:186 ran "update-status" hook (via hook dispatching script: dispatch)
2025-05-14T12:33:23.202Z [container-agent] 2025-05-14 12:33:23 INFO juju.worker.uniter.operation runhook.go:186 ran "update-status" hook (via hook dispatching script: dispatch)
2025-05-14T12:38:41.847Z [container-agent] 2025-05-14 12:38:41 INFO juju.worker.uniter.operation runhook.go:186 ran "update-status" hook (via hook dispatching script: dispatch)
2025-05-14T12:42:46.020Z [container-agent] 2025-05-14 12:42:46 INFO juju.worker.uniter.operation runhook.go:186 ran "update-status" hook (via hook dispatching script: dispatch)
2025-05-14T12:46:48.672Z [container-agent] 2025-05-14 12:46:48 INFO juju.worker.uniter.operation runhook.go:186 ran "update-status" hook (via hook dispatching script: dispatch)
2025-05-14T12:52:00.500Z [container-agent] 2025-05-14 12:52:00 INFO juju.worker.uniter.operation runhook.go:186 ran "update-status" hook (via hook dispatching script: dispatch)
2025-05-14T12:57:31.656Z [container-agent] 2025-05-14 12:57:31 ERROR juju.worker.dependency engine.go:695 "migration-minion" manifold worker returned unexpected error: hub txn watcher sync error: starting change stream: read tcp 127.0.0.1:50396->127.0.0.1:37017: i/o timeout
2025-05-14T12:57:31.656Z [container-agent] 2025-05-14 12:57:31 ERROR juju.worker.dependency engine.go:695 "log-sender" manifold worker returned unexpected error: sending log message: write tcp 10.1.0.250:52038->10.152.183.59:17070: write: broken pipe: write tcp 10.1.0.250:52038->10.152.183.59:17070: write: broken pipe
2025-05-14T12:57:31.718Z [container-agent] 2025-05-14 12:57:31 ERROR juju.api.watcher watcher.go:95 error trying to stop watcher: codec.ReadHeader error: error receiving message: write tcp 10.1.0.250:52022->10.152.183.59:17070: write: connection reset by peer
2025-05-14T12:57:31.718Z [container-agent] 2025-05-14 12:57:31 ERROR juju.api.watcher watcher.go:95 error trying to stop watcher: codec.ReadHeader error: error receiving message: write tcp 10.1.0.250:52022->10.152.183.59:17070: write: connection reset by peer
2025-05-14T12:57:31.718Z [container-agent] 2025-05-14 12:57:31 ERROR juju.api.watcher watcher.go:95 error trying to stop watcher: codec.ReadHeader error: error receiving message: write tcp 10.1.0.250:52022->10.152.183.59:17070: write: connection reset by peer
2025-05-14T12:57:31.718Z [container-agent] 2025-05-14 12:57:31 ERROR juju.api.watcher watcher.go:95 error trying to stop watcher: codec.ReadHeader error: error receiving message: write tcp 10.1.0.250:52022->10.152.183.59:17070: write: connection reset by peer
2025-05-14T12:57:31.718Z [container-agent] 2025-05-14 12:57:31 ERROR juju.api.watcher watcher.go:95 error trying to stop watcher: codec.ReadHeader error: error receiving message: write tcp 10.1.0.250:52022->10.152.183.59:17070: write: connection reset by peer
2025-05-14T12:57:31.718Z [container-agent] 2025-05-14 12:57:31 ERROR juju.api.watcher watcher.go:95 error trying to stop watcher: codec.ReadHeader error: error receiving message: write tcp 10.1.0.250:52022->10.152.183.59:17070: write: connection reset by peer
2025-05-14T12:57:31.718Z [container-agent] 2025-05-14 12:57:31 ERROR juju.api.watcher watcher.go:95 error trying to stop watcher: codec.ReadHeader error: error receiving message: write tcp 10.1.0.250:52022->10.152.183.59:17070: write: connection reset by peer
2025-05-14T12:57:31.718Z [container-agent] 2025-05-14 12:57:31 ERROR juju.api.watcher watcher.go:95 error trying to stop watcher: codec.ReadHeader error: error receiving message: write tcp 10.1.0.250:52022->10.152.183.59:17070: write: connection reset by peer
2025-05-14T12:57:31.718Z [container-agent] 2025-05-14 12:57:31 ERROR juju.api.watcher watcher.go:95 error trying to stop watcher: codec.ReadHeader error: error receiving message: write tcp 10.1.0.250:52022->10.152.183.59:17070: write: connection reset by peer
2025-05-14T12:57:31.718Z [container-agent] 2025-05-14 12:57:31 ERROR juju.api.watcher watcher.go:95 error trying to stop watcher: codec.ReadHeader error: error receiving message: write tcp 10.1.0.250:52022->10.152.183.59:17070: write: connection reset by peer
2025-05-14T12:57:31.718Z [container-agent] 2025-05-14 12:57:31 ERROR juju.worker.dependency engine.go:695 "api-caller" manifold worker returned unexpected error: codec.ReadHeader error: error receiving message: write tcp 10.1.0.250:52022->10.152.183.59:17070: write: connection reset by peer
2025-05-14T12:57:31.718Z [container-agent] 2025-05-14 12:57:31 ERROR juju.api.watcher watcher.go:95 error trying to stop watcher: codec.ReadHeader error: error receiving message: write tcp 10.1.0.250:52022->10.152.183.59:17070: write: connection reset by peer
2025-05-14T12:57:31.718Z [container-agent] 2025-05-14 12:57:31 INFO juju.worker.logger logger.go:136 logger worker stopped
2025-05-14T12:57:31.718Z [container-agent] 2025-05-14 12:57:31 ERROR juju.api.watcher watcher.go:95 error trying to stop watcher: codec.ReadHeader error: error receiving message: write tcp 10.1.0.250:52022->10.152.183.59:17070: write: connection reset by peer
2025-05-14T12:57:31.718Z [container-agent] 2025-05-14 12:57:31 ERROR juju.api.watcher watcher.go:95 error trying to stop watcher: codec.ReadHeader error: error receiving message: write tcp 10.1.0.250:52022->10.152.183.59:17070: write: connection reset by peer
2025-05-14T12:57:31.718Z [container-agent] 2025-05-14 12:57:31 ERROR juju.api.watcher watcher.go:95 error trying to stop watcher: codec.ReadHeader error: error receiving message: write tcp 10.1.0.250:52022->10.152.183.59:17070: write: connection reset by peer
2025-05-14T12:57:31.718Z [container-agent] 2025-05-14 12:57:31 ERROR juju.api.watcher watcher.go:95 error trying to stop watcher: codec.ReadHeader error: error receiving message: write tcp 10.1.0.250:52022->10.152.183.59:17070: write: connection reset by peer
2025-05-14T12:57:31.718Z [container-agent] 2025-05-14 12:57:31 ERROR juju.api.watcher watcher.go:95 error trying to stop watcher: codec.ReadHeader error: error receiving message: write tcp 10.1.0.250:52022->10.152.183.59:17070: write: connection reset by peer
2025-05-14T12:57:31.718Z [container-agent] 2025-05-14 12:57:31 ERROR juju.api.watcher watcher.go:95 error trying to stop watcher: codec.ReadHeader error: error receiving message: write tcp 10.1.0.250:52022->10.152.183.59:17070: write: connection reset by peer
2025-05-14T12:57:31.718Z [container-agent] 2025-05-14 12:57:31 ERROR juju.api.watcher watcher.go:95 error trying to stop watcher: codec.ReadHeader error: error receiving message: write tcp 10.1.0.250:52022->10.152.183.59:17070: write: connection reset by peer
2025-05-14T12:57:31.718Z [container-agent] 2025-05-14 12:57:31 ERROR juju.api.watcher watcher.go:95 error trying to stop watcher: codec.ReadHeader error: error receiving message: write tcp 10.1.0.250:52022->10.152.183.59:17070: write: connection reset by peer
2025-05-14T12:57:31.718Z [container-agent] 2025-05-14 12:57:31 ERROR juju.api.watcher watcher.go:95 error trying to stop watcher: codec.ReadHeader error: error receiving message: write tcp 10.1.0.250:52022->10.152.183.59:17070: write: connection reset by peer
2025-05-14T12:57:31.718Z [container-agent] 2025-05-14 12:57:31 ERROR juju.api.watcher watcher.go:95 error trying to stop watcher: codec.ReadHeader error: error receiving message: write tcp 10.1.0.250:52022->10.152.183.59:17070: write: connection reset by peer
2025-05-14T12:57:31.718Z [container-agent] 2025-05-14 12:57:31 ERROR juju.api.watcher watcher.go:95 error trying to stop watcher: codec.ReadHeader error: error receiving message: write tcp 10.1.0.250:52022->10.152.183.59:17070: write: connection reset by peer
2025-05-14T12:57:31.718Z [container-agent] 2025-05-14 12:57:31 ERROR juju.api.watcher watcher.go:95 error trying to stop watcher: codec.ReadHeader error: error receiving message: write tcp 10.1.0.250:52022->10.152.183.59:17070: write: connection reset by peer
2025-05-14T12:57:31.718Z [container-agent] 2025-05-14 12:57:31 ERROR juju.api.watcher watcher.go:95 error trying to stop watcher: codec.ReadHeader error: error receiving message: write tcp 10.1.0.250:52022->10.152.183.59:17070: write: connection reset by peer
2025-05-14T12:57:31.718Z [container-agent] 2025-05-14 12:57:31 ERROR juju.api.watcher watcher.go:95 error trying to stop watcher: codec.ReadHeader error: error receiving message: write tcp 10.1.0.250:52022->10.152.183.59:17070: write: connection reset by peer
2025-05-14T12:57:31.718Z [container-agent] 2025-05-14 12:57:31 ERROR juju.api.watcher watcher.go:95 error trying to stop watcher: codec.ReadHeader error: error receiving message: write tcp 10.1.0.250:52022->10.152.183.59:17070: write: connection reset by peer
2025-05-14T12:57:31.718Z [container-agent] 2025-05-14 12:57:31 ERROR juju.api.watcher watcher.go:95 error trying to stop watcher: codec.ReadHeader error: error receiving message: write tcp 10.1.0.250:52022->10.152.183.59:17070: write: connection reset by peer
2025-05-14T12:57:31.728Z [container-agent] 2025-05-14 12:57:31 ERROR juju.api.watcher watcher.go:95 error trying to stop watcher: codec.ReadHeader error: error receiving message: write tcp 10.1.0.250:52022->10.152.183.59:17070: write: connection reset by peer
2025-05-14T12:57:31.769Z [container-agent] 2025-05-14 12:57:31 ERROR juju.api.watcher watcher.go:95 error trying to stop watcher: codec.ReadHeader error: error receiving message: write tcp 10.1.0.250:52022->10.152.183.59:17070: write: connection reset by peer
2025-05-14T12:57:35.177Z [container-agent] 2025-05-14 12:57:35 INFO juju.api apiclient.go:601 connection established to "wss://172.16.1.201:17070/model/ee070cdf-4b8b-49ac-80cb-918841540fbe/api"
2025-05-14T12:57:35.596Z [container-agent] 2025-05-14 12:57:35 INFO juju.worker.apicaller connect.go:163 [ee070c] "unit-nova-api-mysql-router-0" successfully connected to "wss://172.16.1.201:17070"
2025-05-14T12:57:36.748Z [container-agent] 2025-05-14 12:57:36 INFO juju.worker.logger logger.go:120 logger worker started
2025-05-14T12:57:36.837Z [container-agent] 2025-05-14 12:57:36 WARNING juju.worker.proxyupdater proxyupdater.go:237 unable to set snap core settings [proxy.http= proxy.https= proxy.store=]: exec: "snap": executable file not found in $PATH, output: ""
2025-05-14T12:57:37.100Z [container-agent] 2025-05-14 12:57:37 INFO juju.worker.migrationminion worker.go:208 migration phase is now: NONE
2025-05-14T12:57:37.101Z [container-agent] 2025-05-14 12:57:37 INFO juju.worker.leadership tracker.go:244 nova-api-mysql-router/0 promoted to leadership of nova-api-mysql-router
2025-05-14T12:57:37.589Z [container-agent] 2025-05-14 12:57:37 INFO juju.worker.caasupgrader upgrader.go:113 abort check blocked until version event received
2025-05-14T12:57:37.623Z [container-agent] 2025-05-14 12:57:37 INFO juju.worker.caasupgrader upgrader.go:119 unblocking abort check
2025-05-14T12:57:46.614Z [container-agent] 2025-05-14 12:57:46 ERROR juju-log Uncaught exception while in charm code:
2025-05-14T12:57:46.614Z [container-agent] Traceback (most recent call last):
2025-05-14T12:57:46.614Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/venv/lib/python3.10/site-packages/ops/model.py", line 2955, in _run
2025-05-14T12:57:46.614Z [container-agent]     result = subprocess.run(args, **kwargs)  # type: ignore
2025-05-14T12:57:46.614Z [container-agent]   File "/usr/lib/python3.10/subprocess.py", line 526, in run
2025-05-14T12:57:46.614Z [container-agent]     raise CalledProcessError(retcode, process.args,
2025-05-14T12:57:46.614Z [container-agent] subprocess.CalledProcessError: Command '('/var/lib/juju/tools/unit-nova-api-mysql-router-0/relation-get', '-r', '39', '-', 'nova-api-mysql-router', '--app', '--format=json')' returned non-zero exit status 1.
2025-05-14T12:57:46.614Z [container-agent] 
2025-05-14T12:57:46.614Z [container-agent] The above exception was the direct cause of the following exception:
2025-05-14T12:57:46.614Z [container-agent] 
2025-05-14T12:57:46.614Z [container-agent] Traceback (most recent call last):
2025-05-14T12:57:46.614Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/src/charm.py", line 448, in <module>
2025-05-14T12:57:46.614Z [container-agent]     ops.main.main(KubernetesRouterCharm)
2025-05-14T12:57:46.614Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/venv/lib/python3.10/site-packages/ops/main.py", line 436, in main
2025-05-14T12:57:46.614Z [container-agent]     _emit_charm_event(charm, dispatcher.event_name)
2025-05-14T12:57:46.614Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/venv/lib/python3.10/site-packages/ops/main.py", line 144, in _emit_charm_event
2025-05-14T12:57:46.614Z [container-agent]     event_to_emit.emit(*args, **kwargs)
2025-05-14T12:57:46.614Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/venv/lib/python3.10/site-packages/ops/framework.py", line 351, in emit
2025-05-14T12:57:46.614Z [container-agent]     framework._emit(event)
2025-05-14T12:57:46.614Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/venv/lib/python3.10/site-packages/ops/framework.py", line 853, in _emit
2025-05-14T12:57:46.614Z [container-agent]     self._reemit(event_path)
2025-05-14T12:57:46.614Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/venv/lib/python3.10/site-packages/ops/framework.py", line 942, in _reemit
2025-05-14T12:57:46.614Z [container-agent]     custom_handler(event)
2025-05-14T12:57:46.614Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/lib/charms/tempo_coordinator_k8s/v0/charm_tracing.py", line 735, in wrapped_function
2025-05-14T12:57:46.614Z [container-agent]     return callable(*args, **kwargs)  # type: ignore
2025-05-14T12:57:46.614Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/src/abstract_charm.py", line 275, in reconcile
2025-05-14T12:57:46.614Z [container-agent]     if not self._upgrade.versions_set:
2025-05-14T12:57:46.614Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/src/upgrade.py", line 169, in versions_set
2025-05-14T12:57:46.614Z [container-agent]     return self._app_databag.get("versions") is not None
2025-05-14T12:57:46.614Z [container-agent]   File "/usr/lib/python3.10/_collections_abc.py", line 824, in get
2025-05-14T12:57:46.614Z [container-agent]     return self[key]
2025-05-14T12:57:46.614Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/venv/lib/python3.10/site-packages/ops/model.py", line 1685, in __getitem__
2025-05-14T12:57:46.614Z [container-agent]     return super().__getitem__(key)
2025-05-14T12:57:46.614Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/venv/lib/python3.10/site-packages/ops/model.py", line 790, in __getitem__
2025-05-14T12:57:46.614Z [container-agent]     return self._data[key]
2025-05-14T12:57:46.614Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/venv/lib/python3.10/site-packages/ops/model.py", line 774, in _data
2025-05-14T12:57:46.614Z [container-agent]     data = self._lazy_data = self._load()
2025-05-14T12:57:46.614Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/venv/lib/python3.10/site-packages/ops/model.py", line 1569, in _load
2025-05-14T12:57:46.614Z [container-agent]     return self._backend.relation_get(self.relation.id, self._entity.name, self._is_app)
2025-05-14T12:57:46.614Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/venv/lib/python3.10/site-packages/ops/model.py", line 3036, in relation_get
2025-05-14T12:57:46.614Z [container-agent]     raw_data_content = self._run(*args, return_output=True, use_json=True)
2025-05-14T12:57:46.614Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/venv/lib/python3.10/site-packages/ops/model.py", line 2957, in _run
2025-05-14T12:57:46.614Z [container-agent]     raise ModelError(e.stderr) from e
2025-05-14T12:57:46.614Z [container-agent] ops.model.ModelError: ERROR connection is shut down
2025-05-14T12:57:46.614Z [container-agent] 
2025-05-14T12:57:48.014Z [container-agent] 2025-05-14 12:57:48 ERROR juju.worker.uniter.operation runhook.go:180 hook "update-status" (via hook dispatching script: dispatch) failed: exit status 1
2025-05-14T12:57:48.015Z [container-agent] 2025-05-14 12:57:48 INFO juju.worker.uniter uniter.go:349 unit "nova-api-mysql-router/0" shutting down: (re)starting watcher: connection is shut down
2025-05-14T12:57:48.201Z [container-agent] 2025-05-14 12:57:48 INFO juju.agent.tools symlinks.go:20 ensure jujuc symlinks in /var/lib/juju/tools/unit-nova-api-mysql-router-0
2025-05-14T12:57:50.626Z [container-agent] 2025-05-14 12:57:50 INFO juju.worker.uniter uniter.go:365 unit "nova-api-mysql-router/0" started
2025-05-14T12:57:50.991Z [container-agent] 2025-05-14 12:57:50 INFO juju.worker.uniter uniter.go:391 hooks are retried true
2025-05-14T12:57:51.897Z [container-agent] 2025-05-14 12:57:51 INFO juju.worker.uniter resolver.go:180 awaiting error resolution for "update-status" hook
2025-05-14T12:57:55.298Z [pebble] Check "readiness" failure 1/3: non-2xx status code 418
2025-05-14T12:57:55.644Z [container-agent] 2025-05-14 12:57:55 INFO juju.worker.uniter resolver.go:180 awaiting error resolution for "update-status" hook
2025-05-14T12:57:56.979Z [container-agent] 2025-05-14 12:57:56 INFO juju.worker.uniter resolver.go:180 awaiting error resolution for "update-status" hook
2025-05-14T12:58:05.267Z [pebble] Check "readiness" failure 2/3: non-2xx status code 418
2025-05-14T12:58:15.268Z [pebble] Check "readiness" failure 3/3: non-2xx status code 418
2025-05-14T12:58:15.268Z [pebble] Check "readiness" threshold 3 hit, triggering action and recovering
2025-05-14T12:58:15.273Z [pebble] Change 67 task (Perform HTTP check "readiness") failed: non-2xx status code 418
2025-05-14T12:58:25.612Z [pebble] Check "readiness" failure 4/3: non-2xx status code 418
2025-05-14T12:58:25.674Z [container-agent] 2025-05-14 12:58:25 ERROR juju-log Failed to run MySQL Shell script:
2025-05-14T12:58:25.674Z [container-agent] import json
2025-05-14T12:58:25.674Z [container-agent] import mysqlsh
2025-05-14T12:58:25.674Z [container-agent] import traceback
2025-05-14T12:58:25.674Z [container-agent] 
2025-05-14T12:58:25.674Z [container-agent] try:
2025-05-14T12:58:25.674Z [container-agent]     # Disable wizards in this script, since it will be invoked without --no-wizard
2025-05-14T12:58:25.674Z [container-agent]     shell.options.set('useWizards', False)
2025-05-14T12:58:25.674Z [container-agent]     import json
2025-05-14T12:58:25.674Z [container-agent] 
2025-05-14T12:58:25.674Z [container-agent]     cluster_set = dba.get_cluster_set()
2025-05-14T12:58:25.674Z [container-agent]     routers = cluster_set.list_routers()
2025-05-14T12:58:25.674Z [container-agent]     # mysqlsh objects are weirdâ€”they quack (i.e. duck typing) like standard Python objects (e.g. list,
2025-05-14T12:58:25.674Z [container-agent]     # dict), but do not serialize to JSON correctly.
2025-05-14T12:58:25.674Z [container-agent]     # Cast to str & load from JSON str before serializing
2025-05-14T12:58:25.674Z [container-agent]     routers = json.loads(str(routers))
2025-05-14T12:58:25.674Z [container-agent]     with open("/tmp/mysqlsh_output.json", "w") as file:
2025-05-14T12:58:25.674Z [container-agent]         json.dump(routers, file)
2025-05-14T12:58:25.674Z [container-agent] except mysqlsh.DBError as exception:
2025-05-14T12:58:25.674Z [container-agent]     error = {
2025-05-14T12:58:25.674Z [container-agent]         "message": str(exception),
2025-05-14T12:58:25.674Z [container-agent]         "code": exception.code,
2025-05-14T12:58:25.674Z [container-agent]         "traceback_message": "".join(traceback.format_exception(exception)),
2025-05-14T12:58:25.674Z [container-agent]     }
2025-05-14T12:58:25.674Z [container-agent] else:
2025-05-14T12:58:25.674Z [container-agent]     error = None
2025-05-14T12:58:25.674Z [container-agent] with open("/tmp/mysqlsh_error.json", "w") as file:
2025-05-14T12:58:25.674Z [container-agent]     json.dump(error, file)
2025-05-14T12:58:25.674Z [container-agent] 
2025-05-14T12:58:25.674Z [container-agent] stderr:
2025-05-14T12:58:25.674Z [container-agent] Cannot set LC_ALL to locale en_US.UTF-8: No such file or directory
2025-05-14T12:58:25.674Z [container-agent] MySQL Error 2003 (HY000): Can't connect to MySQL server on 'mysql-primary.openstack.svc.cluster.local:3306' (1)
2025-05-14T12:58:25.674Z [container-agent] 
2025-05-14T12:58:25.674Z [container-agent] Traceback (most recent call last):
2025-05-14T12:58:25.674Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/src/rock.py", line 245, in _run_command
2025-05-14T12:58:25.674Z [container-agent]     output, _ = process.wait_output()
2025-05-14T12:58:25.674Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/venv/lib/python3.10/site-packages/ops/pebble.py", line 1441, in wait_output
2025-05-14T12:58:25.674Z [container-agent]     raise ExecError[AnyStr](self._command, exit_code, out_value, err_value)
2025-05-14T12:58:25.674Z [container-agent] ops.pebble.ExecError: non-zero exit code 1 executing ['mysqlsh', '--passwords-from-stdin', '--uri', 'relation-105_ee070cdf4b8b4@mysql-primary.openstack.svc.cluster.local:3306', '--python', '--file', '/tmp/mysqlsh_script.py'], stdout="\x1b[1mPlease provide the password for 'relation-105_ee070cdf4b8b4@mysql-primary.openstack.svc.cluster.local:3306': \x1b[0m", stderr="Cannot set LC_ALL to locale en_US.UTF-8: No such file or directory\nMySQL Error 2003 (HY000): Can't connect to MySQL server on 'mysql-primary.openstack.svc.cluster.local:3306' (1)\n"
2025-05-14T12:58:25.674Z [container-agent] 
2025-05-14T12:58:25.674Z [container-agent] During handling of the above exception, another exception occurred:
2025-05-14T12:58:25.674Z [container-agent] 
2025-05-14T12:58:25.674Z [container-agent] Traceback (most recent call last):
2025-05-14T12:58:25.674Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/src/mysql_shell/__init__.py", line 74, in _run_code
2025-05-14T12:58:25.674Z [container-agent]     self._container.run_mysql_shell(
2025-05-14T12:58:25.674Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/lib/charms/tempo_coordinator_k8s/v0/charm_tracing.py", line 735, in wrapped_function
2025-05-14T12:58:25.674Z [container-agent]     return callable(*args, **kwargs)  # type: ignore
2025-05-14T12:58:25.674Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/src/container.py", line 212, in run_mysql_shell
2025-05-14T12:58:25.674Z [container-agent]     return self._run_command(args, timeout=timeout, input=input)
2025-05-14T12:58:25.674Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/lib/charms/tempo_coordinator_k8s/v0/charm_tracing.py", line 735, in wrapped_function
2025-05-14T12:58:25.674Z [container-agent]     return callable(*args, **kwargs)  # type: ignore
2025-05-14T12:58:25.674Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/src/rock.py", line 247, in _run_command
2025-05-14T12:58:25.674Z [container-agent]     raise container.CalledProcessError(
2025-05-14T12:58:25.674Z [container-agent] container.CalledProcessError: Command '['mysqlsh', '--passwords-from-stdin', '--uri', 'relation-105_ee070cdf4b8b4@mysql-primary.openstack.svc.cluster.local:3306', '--python', '--file', '/tmp/mysqlsh_script.py']' returned non-zero exit status 1.
2025-05-14T12:58:25.986Z [container-agent] 2025-05-14 12:58:25 ERROR juju-log Uncaught exception while in charm code:
2025-05-14T12:58:25.986Z [container-agent] Traceback (most recent call last):
2025-05-14T12:58:25.986Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/src/rock.py", line 245, in _run_command
2025-05-14T12:58:25.986Z [container-agent]     output, _ = process.wait_output()
2025-05-14T12:58:25.986Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/venv/lib/python3.10/site-packages/ops/pebble.py", line 1441, in wait_output
2025-05-14T12:58:25.986Z [container-agent]     raise ExecError[AnyStr](self._command, exit_code, out_value, err_value)
2025-05-14T12:58:25.986Z [container-agent] ops.pebble.ExecError: non-zero exit code 1 executing ['mysqlsh', '--passwords-from-stdin', '--uri', 'relation-105_ee070cdf4b8b4@mysql-primary.openstack.svc.cluster.local:3306', '--python', '--file', '/tmp/mysqlsh_script.py'], stdout="\x1b[1mPlease provide the password for 'relation-105_ee070cdf4b8b4@mysql-primary.openstack.svc.cluster.local:3306': \x1b[0m", stderr="Cannot set LC_ALL to locale en_US.UTF-8: No such file or directory\nMySQL Error 2003 (HY000): Can't connect to MySQL server on 'mysql-primary.openstack.svc.cluster.local:3306' (1)\n"
2025-05-14T12:58:25.986Z [container-agent] 
2025-05-14T12:58:25.986Z [container-agent] During handling of the above exception, another exception occurred:
2025-05-14T12:58:25.986Z [container-agent] 
2025-05-14T12:58:25.986Z [container-agent] Traceback (most recent call last):
2025-05-14T12:58:25.986Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/src/charm.py", line 448, in <module>
2025-05-14T12:58:25.986Z [container-agent]     ops.main.main(KubernetesRouterCharm)
2025-05-14T12:58:25.986Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/venv/lib/python3.10/site-packages/ops/main.py", line 436, in main
2025-05-14T12:58:25.986Z [container-agent]     _emit_charm_event(charm, dispatcher.event_name)
2025-05-14T12:58:25.986Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/venv/lib/python3.10/site-packages/ops/main.py", line 144, in _emit_charm_event
2025-05-14T12:58:25.986Z [container-agent]     event_to_emit.emit(*args, **kwargs)
2025-05-14T12:58:25.986Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/venv/lib/python3.10/site-packages/ops/framework.py", line 351, in emit
2025-05-14T12:58:25.986Z [container-agent]     framework._emit(event)
2025-05-14T12:58:25.986Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/venv/lib/python3.10/site-packages/ops/framework.py", line 853, in _emit
2025-05-14T12:58:25.986Z [container-agent]     self._reemit(event_path)
2025-05-14T12:58:25.986Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/venv/lib/python3.10/site-packages/ops/framework.py", line 942, in _reemit
2025-05-14T12:58:25.986Z [container-agent]     custom_handler(event)
2025-05-14T12:58:25.986Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/lib/charms/tempo_coordinator_k8s/v0/charm_tracing.py", line 735, in wrapped_function
2025-05-14T12:58:25.986Z [container-agent]     return callable(*args, **kwargs)  # type: ignore
2025-05-14T12:58:25.986Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/src/abstract_charm.py", line 371, in reconcile
2025-05-14T12:58:25.986Z [container-agent]     if not workload_.status or workload_.status == ops.WaitingStatus():
2025-05-14T12:58:25.986Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/src/workload.py", line 414, in status
2025-05-14T12:58:25.986Z [container-agent]     if not self.shell.is_router_in_cluster_set(self._router_id):
2025-05-14T12:58:25.986Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/src/mysql_shell/__init__.py", line 214, in is_router_in_cluster_set
2025-05-14T12:58:25.986Z [container-agent]     self._run_code(
2025-05-14T12:58:25.986Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/src/mysql_shell/__init__.py", line 74, in _run_code
2025-05-14T12:58:25.986Z [container-agent]     self._container.run_mysql_shell(
2025-05-14T12:58:25.986Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/lib/charms/tempo_coordinator_k8s/v0/charm_tracing.py", line 735, in wrapped_function
2025-05-14T12:58:25.986Z [container-agent]     return callable(*args, **kwargs)  # type: ignore
2025-05-14T12:58:25.986Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/src/container.py", line 212, in run_mysql_shell
2025-05-14T12:58:25.986Z [container-agent]     return self._run_command(args, timeout=timeout, input=input)
2025-05-14T12:58:25.986Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/lib/charms/tempo_coordinator_k8s/v0/charm_tracing.py", line 735, in wrapped_function
2025-05-14T12:58:25.986Z [container-agent]     return callable(*args, **kwargs)  # type: ignore
2025-05-14T12:58:25.986Z [container-agent]   File "/var/lib/juju/agents/unit-nova-api-mysql-router-0/charm/src/rock.py", line 247, in _run_command
2025-05-14T12:58:25.986Z [container-agent]     raise container.CalledProcessError(
2025-05-14T12:58:25.986Z [container-agent] container.CalledProcessError: Command '['mysqlsh', '--passwords-from-stdin', '--uri', 'relation-105_ee070cdf4b8b4@mysql-primary.openstack.svc.cluster.local:3306', '--python', '--file', '/tmp/mysqlsh_script.py']' returned non-zero exit status 1.
2025-05-14T12:58:27.199Z [container-agent] 2025-05-14 12:58:27 ERROR juju.worker.uniter.operation runhook.go:180 hook "update-status" (via hook dispatching script: dispatch) failed: exit status 1
2025-05-14T12:58:27.199Z [container-agent] 2025-05-14 12:58:27 INFO juju.worker.uniter resolver.go:180 awaiting error resolution for "update-status" hook
2025-05-14T12:58:35.521Z [pebble] Check "readiness" failure 5/3: non-2xx status code 418
2025-05-14T12:58:37.180Z [container-agent] 2025-05-14 12:58:37 INFO juju.worker.uniter resolver.go:180 awaiting error resolution for "update-status" hook
2025-05-14T12:58:45.537Z [pebble] Check "readiness" failure 6/3: non-2xx status code 418
2025-05-14T12:58:48.630Z [container-agent] 2025-05-14 12:58:48 INFO juju-log Unable to connect to endpoint='nova-api-mysql-router-service.openstack.svc.cluster.local:6446'
2025-05-14T12:58:52.713Z [container-agent] 2025-05-14 12:58:52 INFO juju-log Unable to connect to endpoint='nova-api-mysql-router-service.openstack.svc.cluster.local:6446'
2025-05-14T12:58:52.979Z [container-agent] 2025-05-14 12:58:52 INFO juju-log Unable to connect to endpoint='nova-api-mysql-router-service.openstack.svc.cluster.local:6446'
2025-05-14T12:58:55.515Z [pebble] Check "readiness" failure 7/3: non-2xx status code 418
2025-05-14T12:58:56.607Z [container-agent] 2025-05-14 12:58:56 INFO juju.worker.uniter.operation runhook.go:186 ran "update-status" hook (via hook dispatching script: dispatch)
2025-05-14T12:58:56.634Z [container-agent] 2025-05-14 12:58:56 INFO juju.worker.uniter resolver.go:76 reboot detected; triggering implicit start hook to notify charm
2025-05-14T12:59:01.749Z [container-agent] 2025-05-14 12:59:01 INFO juju-log Unable to connect to endpoint='nova-api-mysql-router-service.openstack.svc.cluster.local:6446'
2025-05-14T12:59:05.431Z [container-agent] 2025-05-14 12:59:05 INFO juju-log Unable to connect to endpoint='nova-api-mysql-router-service.openstack.svc.cluster.local:6446'
2025-05-14T12:59:05.526Z [pebble] Check "readiness" failure 8/3: non-2xx status code 418
2025-05-14T12:59:05.729Z [container-agent] 2025-05-14 12:59:05 INFO juju-log Unable to connect to endpoint='nova-api-mysql-router-service.openstack.svc.cluster.local:6446'
2025-05-14T12:59:09.243Z [container-agent] 2025-05-14 12:59:09 INFO juju.worker.uniter.operation runhook.go:186 ran "start" hook (via hook dispatching script: dispatch)
2025-05-14T12:59:13.388Z [container-agent] 2025-05-14 12:59:13 INFO juju-log Unable to connect to endpoint='nova-api-mysql-router-service.openstack.svc.cluster.local:6446'
2025-05-14T12:59:16.054Z [container-agent] 2025-05-14 12:59:16 INFO juju-log Unable to connect to endpoint='nova-api-mysql-router-service.openstack.svc.cluster.local:6446'
2025-05-14T12:59:16.170Z [container-agent] 2025-05-14 12:59:16 INFO juju-log Unable to connect to endpoint='nova-api-mysql-router-service.openstack.svc.cluster.local:6446'
2025-05-14T12:59:18.900Z [container-agent] 2025-05-14 12:59:18 INFO juju.worker.uniter.operation runhook.go:186 ran "mysql-router-pebble-ready" hook (via hook dispatching script: dispatch)
2025-05-14T13:02:27.362Z [container-agent] 2025-05-14 13:02:27 INFO juju.worker.uniter.operation runhook.go:186 ran "update-status" hook (via hook dispatching script: dispatch)
2025-05-14T13:06:50.098Z [container-agent] 2025-05-14 13:06:50 INFO juju.worker.uniter.operation runhook.go:186 ran "update-status" hook (via hook dispatching script: dispatch)
2025-05-14T13:12:50.443Z [container-agent] 2025-05-14 13:12:50 INFO juju.worker.uniter.operation runhook.go:186 ran "update-status" hook (via hook dispatching script: dispatch)
2025-05-14T13:17:53.793Z [container-agent] 2025-05-14 13:17:53 INFO juju.worker.uniter.operation runhook.go:186 ran "update-status" hook (via hook dispatching script: dispatch)
2025-05-14T13:23:20.365Z [container-agent] 2025-05-14 13:23:20 INFO juju.worker.uniter.operation runhook.go:186 ran "update-status" hook (via hook dispatching script: dispatch)
2025-05-14T13:27:30.155Z [container-agent] 2025-05-14 13:27:30 INFO juju.worker.uniter.operation runhook.go:186 ran "update-status" hook (via hook dispatching script: dispatch)
2025-05-14T13:32:53.765Z [container-agent] 2025-05-14 13:32:53 INFO juju.worker.uniter.operation runhook.go:186 ran "update-status" hook (via hook dispatching script: dispatch)
2025-05-14T13:37:26.018Z [container-agent] 2025-05-14 13:37:26 INFO juju.worker.uniter.operation runhook.go:186 ran "update-status" hook (via hook dispatching script: dispatch)
2025-05-14T13:42:17.395Z [container-agent] 2025-05-14 13:42:17 INFO juju.worker.uniter.operation runhook.go:186 ran "update-status" hook (via hook dispatching script: dispatch)
2025-05-14T13:47:11.224Z [container-agent] 2025-05-14 13:47:11 INFO juju.worker.uniter.operation runhook.go:186 ran "update-status" hook (via hook dispatching script: dispatch)
2025-05-14T14:07:24.518Z [container-agent] 2025-05-14 14:07:24 ERROR juju.worker.dependency engine.go:695 "api-caller" manifold worker returned unexpected error: codec.ReadHeader error: error receiving message: read tcp 10.1.0.250:35378->172.16.1.201:17070: read: connection reset by peer
2025-05-14T14:07:24.518Z [container-agent] 2025-05-14 14:07:24 ERROR juju.api.watcher watcher.go:95 error trying to stop watcher: codec.ReadHeader error: error receiving message: read tcp 10.1.0.250:35378->172.16.1.201:17070: read: connection reset by peer
2025-05-14T14:07:24.518Z [container-agent] 2025-05-14 14:07:24 INFO juju.worker.logger logger.go:136 logger worker stopped
2025-05-14T14:07:24.528Z [container-agent] 2025-05-14 14:07:24 ERROR juju.api.watcher watcher.go:95 error trying to stop watcher: codec.ReadHeader error: error receiving message: read tcp 10.1.0.250:35378->172.16.1.201:17070: read: connection reset by peer
2025-05-14T14:07:24.537Z [container-agent] 2025-05-14 14:07:24 ERROR juju.api.watcher watcher.go:95 error trying to stop watcher: codec.ReadHeader error: error receiving message: read tcp 10.1.0.250:35378->172.16.1.201:17070: read: connection reset by peer
2025-05-14T14:07:24.537Z [container-agent] 2025-05-14 14:07:24 ERROR juju.api.watcher watcher.go:95 error trying to stop watcher: codec.ReadHeader error: error receiving message: read tcp 10.1.0.250:35378->172.16.1.201:17070: read: connection reset by peer
2025-05-14T14:07:24.625Z [container-agent] 2025-05-14 14:07:24 ERROR juju.worker.uniter agent.go:33 resolver loop error: preparing operation "run update-status hook" for nova-api-mysql-router/0: getting unit payloads: connection is shut down
2025-05-14T14:07:24.727Z [container-agent] 2025-05-14 14:07:24 ERROR juju.worker.uniter agent.go:36 updating agent status: connection is shut down
2025-05-14T14:07:24.727Z [container-agent] 2025-05-14 14:07:24 INFO juju.worker.uniter uniter.go:349 unit "nova-api-mysql-router/0" shutting down: preparing operation "run update-status hook" for nova-api-mysql-router/0: getting unit payloads: connection is shut down
2025-05-14T14:07:27.744Z [container-agent] 2025-05-14 14:07:27 INFO juju.api apiclient.go:979 cannot resolve "controller-service.controller-sunbeam-controller.svc.cluster.local": lookup controller-service.controller-sunbeam-controller.svc.cluster.local: operation was canceled
2025-05-14T14:07:27.753Z [container-agent] 2025-05-14 14:07:27 INFO juju.api apiclient.go:601 connection established to "wss://172.16.1.201:17070/model/ee070cdf-4b8b-49ac-80cb-918841540fbe/api"
2025-05-14T14:07:27.792Z [container-agent] 2025-05-14 14:07:27 INFO juju.worker.dependency engine.go:695 "api-caller" manifold worker returned unexpected error: [ee070c] "unit-nova-api-mysql-router-0" cannot open api: try again (try again)
2025-05-14T14:07:31.783Z [container-agent] 2025-05-14 14:07:31 INFO juju.api apiclient.go:979 cannot resolve "controller-service.controller-sunbeam-controller.svc.cluster.local": lookup controller-service.controller-sunbeam-controller.svc.cluster.local: operation was canceled
2025-05-14T14:07:31.783Z [container-agent] 2025-05-14 14:07:31 INFO juju.api apiclient.go:601 connection established to "wss://10.152.183.59:17070/model/ee070cdf-4b8b-49ac-80cb-918841540fbe/api"
2025-05-14T14:07:31.807Z [container-agent] 2025-05-14 14:07:31 INFO juju.worker.dependency engine.go:695 "api-caller" manifold worker returned unexpected error: [ee070c] "unit-nova-api-mysql-router-0" cannot open api: try again (try again)
2025-05-14T14:07:36.164Z [container-agent] 2025-05-14 14:07:36 INFO juju.api apiclient.go:601 connection established to "wss://10.152.183.59:17070/model/ee070cdf-4b8b-49ac-80cb-918841540fbe/api"
2025-05-14T14:07:36.188Z [container-agent] 2025-05-14 14:07:36 INFO juju.worker.apicaller connect.go:163 [ee070c] "unit-nova-api-mysql-router-0" successfully connected to "wss://10.152.183.59:17070"
2025-05-14T14:07:36.221Z [container-agent] 2025-05-14 14:07:36 INFO juju.worker.migrationminion worker.go:208 migration phase is now: NONE
2025-05-14T14:07:36.221Z [container-agent] 2025-05-14 14:07:36 INFO juju.worker.logger logger.go:120 logger worker started
2025-05-14T14:07:36.233Z [container-agent] 2025-05-14 14:07:36 INFO juju.worker.leadership tracker.go:244 nova-api-mysql-router/0 promoted to leadership of nova-api-mysql-router
2025-05-14T14:07:36.242Z [container-agent] 2025-05-14 14:07:36 WARNING juju.worker.proxyupdater proxyupdater.go:237 unable to set snap core settings [proxy.http= proxy.https= proxy.store=]: exec: "snap": executable file not found in $PATH, output: ""
2025-05-14T14:07:36.296Z [container-agent] 2025-05-14 14:07:36 INFO juju.worker.caasupgrader upgrader.go:113 abort check blocked until version event received
2025-05-14T14:07:36.296Z [container-agent] 2025-05-14 14:07:36 INFO juju.worker.caasupgrader upgrader.go:119 unblocking abort check
2025-05-14T14:07:36.328Z [container-agent] 2025-05-14 14:07:36 INFO juju.agent.tools symlinks.go:20 ensure jujuc symlinks in /var/lib/juju/tools/unit-nova-api-mysql-router-0
2025-05-14T14:07:36.950Z [container-agent] 2025-05-14 14:07:36 INFO juju.worker.uniter uniter.go:365 unit "nova-api-mysql-router/0" started
2025-05-14T14:07:36.976Z [container-agent] 2025-05-14 14:07:36 INFO juju.worker.uniter uniter.go:391 hooks are retried true
2025-05-14T14:07:37.305Z [container-agent] 2025-05-14 14:07:37 INFO juju.worker.uniter resolver.go:76 reboot detected; triggering implicit start hook to notify charm
2025-05-14T14:07:45.614Z [pebble] Check "readiness" failure 1/3: non-2xx status code 418
2025-05-14T14:07:55.578Z [pebble] Check "readiness" failure 2/3: non-2xx status code 418
2025-05-14T14:07:59.168Z [container-agent] 2025-05-14 14:07:59 INFO juju.worker.uniter.operation runhook.go:186 ran "start" hook (via hook dispatching script: dispatch)
2025-05-14T14:08:17.234Z [container-agent] 2025-05-14 14:08:17 INFO juju.worker.uniter.operation runhook.go:186 ran "mysql-router-pebble-ready" hook (via hook dispatching script: dispatch)
2025-05-14T14:12:18.860Z [container-agent] 2025-05-14 14:12:18 INFO juju.worker.uniter.operation runhook.go:186 ran "update-status" hook (via hook dispatching script: dispatch)
2025-05-14T14:16:51.740Z [container-agent] 2025-05-14 14:16:51 INFO juju.worker.uniter.operation runhook.go:186 ran "update-status" hook (via hook dispatching script: dispatch)
2025-05-14T14:22:06.133Z [container-agent] 2025-05-14 14:22:06 INFO juju.worker.uniter.operation runhook.go:186 ran "update-status" hook (via hook dispatching script: dispatch)
2025-05-14T14:26:40.729Z [container-agent] 2025-05-14 14:26:40 INFO juju.worker.uniter.operation runhook.go:186 ran "update-status" hook (via hook dispatching script: dispatch)
2025-05-14T14:32:06.662Z [container-agent] 2025-05-14 14:32:06 INFO juju.worker.uniter.operation runhook.go:186 ran "update-status" hook (via hook dispatching script: dispatch)
2025-05-14T14:36:53.890Z [container-agent] 2025-05-14 14:36:53 INFO juju.worker.uniter.operation runhook.go:186 ran "update-status" hook (via hook dispatching script: dispatch)
2025-05-14T14:42:18.955Z [container-agent] 2025-05-14 14:42:18 INFO juju.worker.uniter.operation runhook.go:186 ran "update-status" hook (via hook dispatching script: dispatch)
2025-05-14T14:47:46.471Z [container-agent] 2025-05-14 14:47:46 INFO juju.worker.uniter.operation runhook.go:186 ran "update-status" hook (via hook dispatching script: dispatch)
2025-05-14T14:52:10.435Z [container-agent] 2025-05-14 14:52:10 INFO juju.worker.uniter.operation runhook.go:186 ran "update-status" hook (via hook dispatching script: dispatch)
2025-05-14T14:57:22.983Z [container-agent] 2025-05-14 14:57:22 INFO juju.worker.uniter.operation runhook.go:186 ran "update-status" hook (via hook dispatching script: dispatch)
2025-05-14T15:01:50.432Z [container-agent] 2025-05-14 15:01:50 INFO juju.worker.uniter.operation runhook.go:186 ran "update-status" hook (via hook dispatching script: dispatch)
2025-05-14T15:05:57.882Z [container-agent] 2025-05-14 15:05:57 INFO juju.worker.uniter.operation runhook.go:186 ran "update-status" hook (via hook dispatching script: dispatch)
