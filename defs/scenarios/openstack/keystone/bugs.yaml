checks:
  has_1896125:
    apt:
      python3-keystone:
        # Train
        - min: 2:16.0.0
          max: 2:16.0.1
        # Ussuri
        - min: 2:17.0.0
          max: 2:17.0.0-99
        # Victoria
        - min: 2:18.0.0
          max: 2:18.0.0-99
conclusions:
  lp1896125:
    decision: has_1896125
    raises:
      type: LaunchpadBug
      bug-id: 1896125
      message: >-
        Installed package '{package}' with version {version} has a known bug
        that causes memory leak over time and causes LDAP logins to fail. It
        is recommended to upgrade to the next point release available for the
        package. To workaround LDAP login failure problem, disable LDAP pooling
        by setting `ldap-use-pool` to `false` for all deployed `keystone-ldap`
        applications in charmed deployments. For non-charmed deployments, set
        `use_pool` to `false` in the LDAP domain /etc/keystone/domains/*.conf
        file.
      format-dict:
        package: '@checks.has_1896125.requires.package'
        version: '@checks.has_1896125.requires.version'