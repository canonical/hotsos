# Check that if bluestore is enabled, there is no journal device configured.
# This can happen e.g. after an upgrade from Filestore to Bluestore.
checks:
  bluestore_enabled:
    requires:
      property: hotsos.core.plugins.storage.ceph.CephChecksBase.bluestore_enabled
  ceph_config_has_journal:
    requires:
      config:
        handler: hotsos.core.plugins.storage.ceph.CephConfig
        assertions:
          osd_journal:
            ops: [[ne, null]]
conclusions:
  bluestore-using-filestore-journal:
    decision:
      and:
        - bluestore_enabled
        - ceph_config_has_journal
    raises:
      type: hotsos.core.issues.CephWarning
      message: >-
        Ceph Bluestore is enabled yet there is a still a journal device
        configured in ceph.conf - please check
