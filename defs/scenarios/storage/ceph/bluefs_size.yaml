checks:
  bluefs_osds_have_oversize_metadata:
    requires:
      property:
        path: hotsos.core.plugins.storage.ceph.CephCluster.bluefs_oversized_metadata_osds
        ops: [[length_hint], [gt, 0]]
conclusions:
  bluefs-osds-have-oversize-metadata:
    decision: bluefs_osds_have_oversize_metadata
    raises:
      type: hotsos.core.issues.CephWarning
      message: >-
        Found {num_bad_meta_osds} Ceph OSDs with metadata size larger than 10G.
        This could be the result of a compaction failure/bug and this host may
        be affected by https://tracker.ceph.com/issues/45903. A workaround (>=
        Nautilus) is to manually compact using 'ceph-bluestore-tool'.
      format-dict:
        num_bad_meta_osds: '@checks.bluefs_osds_have_oversize_metadata.requires.value_actual:len'

