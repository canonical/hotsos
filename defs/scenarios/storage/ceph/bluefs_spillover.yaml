checks:
  bluefs_spillover:
    input:
      command: ceph_health_detail_json_decoded
    expr: '.+experiencing BlueFS spillover'
  health_warning:
    requires:
      property: hotsos.core.plugins.storage.ceph.CephCluster.health_status
      value: HEALTH_WARN
conclusions:
  bluefs-spillover:
    decision:
      and:
        - bluefs_spillover
        - health_warning
    raises:
      type: hotsos.core.issues.CephWarning
      message: >-
        Identified known Ceph bug https://tracker.ceph.com/issues/38745.
        RocksDB needs more space than the leveled space available.
        See www.mail-archive.com/ceph-users@ceph.io/msg05782.html
